<!DOCTYPE html>
<html>

  <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <title>Using Heat for autoscaling</title>
  <meta name="description" content="OpenStack provides autoscaling features through Heat. This feature reduces the need to manually provision instance capacities in advance. You can use Heat re...">

  <link rel="stylesheet" href="/help-documentation/css/main.css">
  <link rel="canonical" href="http://ibm-blue-box-help.github.io/help-documentation/heat/autoscaling-with-heat/">
  <link rel="alternate" type="application/rss+xml" title="Blue Box Help" href="http://ibm-blue-box-help.github.io/help-documentation/feed.xml">
  
  <style>
   .site-header img:first-child {
       height: 72px;
}
</style>
  
</head>


  <body>

  
    <header class="site-header">

  <div class="header-wrapper">

    <a class="site-title" href="/help-documentation/"><img src="/help-documentation/img/en/Bluemix-logo-UI.svg" alt="" height="72px"></a>

    <div class="search--pageview">

  <div class="full-view__search hide">
    <a href="" class="x hide">X</a>
    <ul id="results-container"></ul>
    <ul class="results--container"></ul>

  </div>
  <div class="input-container">
    <label for="search__fullview" class="hide search--label">Search IBM Bluemix Private Cloud Help</label>
    <input type="text" id="search-input" placeholder="" name="search" class="search__minview--page">
    <img src="/help-documentation/img/en/search.svg" class="search-icon" />
  </div>
</div>


    <a href="mailto:llundquist@us.ibm.com" class="header--request">
      <p>
        Submit A Request
      </p>
      <img src="/help-documentation/img/en/user.svg">
    </a>
    <a id="nav-toggle" href="#"><span></span></a>

    <div>
  
    
      <a style="font-weight: bold;" href=" /help-documentation/heat/autoscaling-with-heat/ ">en</a> |
    
      <a  href=" /help-documentation/fr/heat/autoscaling-with-heat/ ">fr</a> |
    
      <a  href=" /help-documentation/de/heat/autoscaling-with-heat/ ">de</a> |
    
      <a  href=" /help-documentation/ja/heat/autoscaling-with-heat/ ">ja</a> |
    
      <a  href=" /help-documentation/zh_CN/heat/autoscaling-with-heat/ ">zh_CN</a> |
    
      <a  href=" /help-documentation/zh_TW/heat/autoscaling-with-heat/ ">zh_TW</a> |
    
      <a  href=" /help-documentation/pt_BR/heat/autoscaling-with-heat/ ">pt_BR</a> |
    
  
</div>

  </div>

</header>

  

  
  <div class="page-content">
  

      <div class="main-wrapper">
        
<div class="sidebar sidebar--toggled">
  <ul class="sidebar__nav">
    <li>
      <h3 class="title">
        
        
        
        <a  class="page-link"  href="/help-documentation/gettingstarted">Getting Started (38)</a>
        <a href=""  class="expand rotate" ><img src="/help-documentation/img/en/arrow.svg" /></a>
      </h3>
      <ul  class="article__list slide-up-hidden" >
        <h5 class="sub__head">Common Technical Questions</h5>
        
        
        
          
          <li>
              <a class="page-link" href="/help-documentation/gettingstarted/commontech/connect-to-openvpn-server/">Connecting to your OpenVPN server</a>
          </li>
          
        
          
          <li>
              <a class="page-link" href="/help-documentation/gettingstarted/commontech/openvpn-setup/">Setting up OpenVPN server on your instance</a>
          </li>
          
        
          
          <li>
              <a class="page-link" href="/help-documentation/gettingstarted/commontech/blue-box-cloud-components/">Bluemix Private Cloud Components</a>
          </li>
          
        
          
          <li>
              <a class="page-link" href="/help-documentation/gettingstarted/commontech/detaching-volume/">What Should I Do Prior to Detaching a Volume?</a>
          </li>
          
        
          
          <li>
              <a class="page-link" href="/help-documentation/gettingstarted/commontech/python-environment-primer/">Virtual python environments and you: A developer's primer</a>
          </li>
          
        
          
          <li>
              <a class="page-link" href="/help-documentation/gettingstarted/commontech/FAQ/">Technical FAQ</a>
          </li>
          
        
          
            
            
              <li class="hidden non-featured">
                  <a class="page-link" href="/help-documentation/gettingstarted/commontech/Building_Blocks/">IBM Bluemix Private Cloud Building Blocks (Community Edition)</a>
              </li>
            
          
        
          
            
            
              <li class="hidden non-featured">
                  <a class="page-link" href="/help-documentation/gettingstarted/commontech/RHOSP_Building_Blocks/">Building Blocks for IBM Bluemix Private Cloud with Red Hat</a>
              </li>
            
          
        
          
            
            
              <li class="hidden non-featured">
                  <a class="page-link" href="/help-documentation/gettingstarted/commontech/RHOSP_Product_Overview/">IBM Bluemix Private Cloud with Red Hat - Product Overview</a>
              </li>
            
          
        
          
            
            
              <li class="hidden non-featured">
                  <a class="page-link" href="/help-documentation/gettingstarted/commontech/general_product_overview/">General Product Overview</a>
              </li>
            
          
        
          
            
            
              <li class="hidden non-featured">
                  <a class="page-link" href="/help-documentation/gettingstarted/commontech/Instance_Resize/">Resizing an Instance (Non-live)</a>
              </li>
            
          
        
          
            
            
              <li class="hidden non-featured">
                  <a class="page-link" href="/help-documentation/gettingstarted/commontech/Connecting_Clouds_with_SoftLayer/">Set Up Network Connectivity Between Multiple Cloud Environments, Using the Private Network</a>
              </li>
            
          
        
          
            
            
              <li class="hidden non-featured">
                  <a class="page-link" href="/help-documentation/gettingstarted/commontech/Windows_License_Activation/">Customer Guide for Windows Activation</a>
              </li>
            
          
        
        <li><a href="" class="page-link view">View More ( 7 )</a></li>
      </ul>
      
      <ul  class="article__list slide-up-hidden" >
        <h5 class="sub__head">Common Administrative Questions</h5>
        
        
        
          
          <li>
              <a class="page-link" href="/help-documentation/gettingstarted/commonadmin/adding-removing-subscribers/">Adding or removing subscribers to a ticket</a>
          </li>
          
        
          
          <li>
              <a class="page-link" href="/help-documentation/gettingstarted/commonadmin/view-my-bill/">How do I view my bill?</a>
          </li>
          
        
          
          <li>
              <a class="page-link" href="/help-documentation/gettingstarted/commonadmin/report-issue/">How do I report an issue?</a>
          </li>
          
        
          
          <li>
              <a class="page-link" href="/help-documentation/gettingstarted/commonadmin/escalating-a-ticket/">How do I escalate a ticket?</a>
          </li>
          
        
          
            
            
              <li class="hidden non-featured">
                  <a class="page-link" href="/help-documentation/gettingstarted/commonadmin/status-pages/">Bluemix Private Cloud Status Pages</a>
              </li>
            
          
        
          
            
            
              <li class="hidden non-featured">
                  <a class="page-link" href="/help-documentation/gettingstarted/commonadmin/Transferring_A_Domain_From_Blue_Box/">Transferring A Domain From Blue Box</a>
              </li>
            
          
        
        <li><a href="" class="page-link view">View More ( 2 )</a></li>
      </ul>
      
      <ul  class="article__list slide-up-hidden" >
        <h5 class="sub__head">User Guides</h5>
        
        
          
             
         
             
         
             
         
             
                
                  
                  <li class="hidden non-featured">
                    <a class="page-link" href="/help-documentation/gettingstarted/userguides/Box_Panel/">Box Panel User Guide</a>
                  </li>
              
             
         
             
                <li>
                <a class="page-link" href="/help-documentation/gettingstarted/userguides/Eternal_Blue-ish_Triangle/">Box Panel, Site Controller, and IBM Bluemix Private Cloud Local</a>
                </li>
              
         
             
                <li>
                <a class="page-link" href="/help-documentation/gettingstarted/userguides/qemu_article/">Building Up to OpenStack â€” QEMU and Your Cloud</a>
                </li>
              
         
             
                <li>
                <a class="page-link" href="/help-documentation/gettingstarted/userguides/Improving_Cloud_Performance/">Building Up to OpenStack II -- Improving Cloud Performance</a>
                </li>
              
         
             
                <li>
                <a class="page-link" href="/help-documentation/gettingstarted/userguides/Optimized_Load_Balancing/">Cloud 101 -- Optimized Load Balancing</a>
                </li>
              
         
             
                
                  
                  <li class="hidden non-featured">
                    <a class="page-link" href="/help-documentation/gettingstarted/userguides/Cloud_Images_Provided_RHOSP/">User's Guide to Cloud Images (IBM Bluemix Private Cloud with Red Hat)</a>
                  </li>
              
             
         
             
                
                  
                  <li class="hidden non-featured">
                    <a class="page-link" href="/help-documentation/gettingstarted/userguides/Cloud_Images_Provided_by_IBM/">User's Guide to Cloud Images (Community Edition)</a>
                  </li>
              
             
         
             
         
             
         
             
         
             
         
             
                
                  
                  <li class="hidden non-featured">
                    <a class="page-link" href="/help-documentation/gettingstarted/userguides/Image_Release_Notes/">IBM Bluemix Private Cloud Image Release Notes</a>
                  </li>
              
             
         
        <li><a href="" class="page-link view">View More ( 4 )</a></li>
      </ul>
      
      <ul  class="article__list slide-up-hidden" >
        <h5 class="sub__head">Release Notes</h5>
        
        
          
             
                
                  
                  <li class="hidden non-featured">
                    <a class="page-link" href="/help-documentation/releasenotes/Customer_3.0.1_Point_Release/">Customer 3.0.1 Point Release Notes</a>
                  </li>
              
             
         
             
                
                  
                  <li class="hidden non-featured">
                    <a class="page-link" href="/help-documentation/releasenotes/Customer_3.1.1_Point_Release/">Customer 3.1.1 Point Release Notes</a>
                  </li>
              
             
         
             
                
                  
                  <li class="hidden non-featured">
                    <a class="page-link" href="/help-documentation/releasenotes/Customer_4.0.0.0c_Release_Notes/">Release Notes 4.0.0.0c</a>
                  </li>
              
             
         
             
                <li>
                <a class="page-link" href="/help-documentation/releasenotes/Customer_4.0.0.0r_Release_Notes/">Release Notes 4.0.0.0r</a>
                </li>
              
         
             
                <li>
                <a class="page-link" href="/help-documentation/releasenotes/Customer_2.1.1_Point_Release/">Release Notes 2.1.1</a>
                </li>
              
         
             
                
                  
                  <li class="hidden non-featured">
                    <a class="page-link" href="/help-documentation/releasenotes/release_notes_2.1_for_customers/">Release Notes 2.1</a>
                  </li>
              
             
         
             
                
                  
                  <li class="hidden non-featured">
                    <a class="page-link" href="/help-documentation/releasenotes/Customer_3.0.0_Release_Notes/">Release Notes 3.0.0</a>
                  </li>
              
             
         
             
                
                  
                  <li class="hidden non-featured">
                    <a class="page-link" href="/help-documentation/releasenotes/Customer_3.1.0_Release_Notes/">Release Notes 3.1.0</a>
                  </li>
              
             
         
        <li><a href="" class="page-link view">View More ( 6 )</a></li>
      </ul>
    </li>
    <li>
      <h3 class="title">
        <a  class="page-link"  href="/help-documentation/troubleshooting">Troubleshooting (19)</a>
        <a href=""  class="expand rotate" ><img src="/help-documentation/img/en/arrow.svg" /></a>
      </h3>
      <ul  class="article__list slide-up-hidden" >
        
        
        
          
          <li>
              <a class="page-link" href="/help-documentation/troubleshooting/libvirt_error/">Instance in error status: libvirt error</a>
          </li>
          
        
          
          <li>
              <a class="page-link" href="/help-documentation/troubleshooting/ssh-too-long-error/">Why does it take 4-5 seconds to SSH to my instance?</a>
          </li>
          
        
          
        
          
          <li>
              <a class="page-link" href="/help-documentation/troubleshooting/ping-instance-error/">Why can't I SSH to an instance, or ping it?</a>
          </li>
          
        
          
          <li>
              <a class="page-link" href="/help-documentation/troubleshooting/nova-microversions-error/">Error: 'Server doesn't support microversions' When Running Nova Commands</a>
          </li>
          
        
          
        
          
            
            
              <li class="hidden non-featured">
                  <a class="page-link" href="/help-documentation/troubleshooting/Bad_Availability_Zone/">Cloud Foundry: Invalid Availability Zone Error</a>
              </li>
            
          
        
          
            
            
              <li class="hidden non-featured">
                  <a class="page-link" href="/help-documentation/troubleshooting/failed_to_create_router/">Attempt to Create a Router is Failing</a>
              </li>
            
          
        
          
          <li>
              <a class="page-link" href="/help-documentation/troubleshooting/How_many_connections_can_HAProxy_handle/">How Many Simultaneous Connections can HAProxy Handle?</a>
          </li>
          
        
          
            
            
              <li class="hidden non-featured">
                  <a class="page-link" href="/help-documentation/troubleshooting/CLI-authentication-error/">When using any of the OpenStack CLIs on Windows, I get authentication failure errors</a>
              </li>
            
          
        
          
            
            
              <li class="hidden non-featured">
                  <a class="page-link" href="/help-documentation/troubleshooting/floating-ips-error/">Why are all the floating IPs that were assigned to me not available?</a>
              </li>
            
          
        
          
            
            
              <li class="hidden non-featured">
                  <a class="page-link" href="/help-documentation/troubleshooting/horizon-delete-error/">Why can't I delete my project/tenant from the Horizon dashboard?</a>
              </li>
            
          
        
          
            
            
              <li class="hidden non-featured">
                  <a class="page-link" href="/help-documentation/troubleshooting/no-valid-host-error/">Error: No valid host was found</a>
              </li>
            
          
        
          
            
            
              <li class="hidden non-featured">
                  <a class="page-link" href="/help-documentation/troubleshooting/Cannot_See_New_vCPUs/">Why Can't I See My New vCPUs Listed in Horizon?</a>
              </li>
            
          
        
          
            
            
              <li class="hidden non-featured">
                  <a class="page-link" href="/help-documentation/troubleshooting/failure_prepping_block_device/">Error: Failure prepping block device</a>
              </li>
            
          
        
          
            
            
              <li class="hidden non-featured">
                  <a class="page-link" href="/help-documentation/troubleshooting/delete_security_group/">Why Canâ€™t I Delete A Security Group?</a>
              </li>
            
          
        
          
          <li>
              <a class="page-link" href="/help-documentation/troubleshooting/Troubleshooting_FAQ/">Troubleshooting FAQ</a>
          </li>
          
        
          
            
            
              <li class="hidden non-featured">
                  <a class="page-link" href="/help-documentation/troubleshooting/Unable_to_ping_tenant_network/">Why Can't I Ping Across My Tenant Networks?</a>
              </li>
            
          
        
          
            
            
              <li class="hidden non-featured">
                  <a class="page-link" href="/help-documentation/troubleshooting/Why_No_vIP_Failover_With_L2pop/">Why can't I use L2pop when I want my vIP instances to failover?</a>
              </li>
            
          
        
        <li><a href="" class="page-link view">View More ( 11 )</a></li>
      </ul>
    </li>
    <li>
      <h3 class="title">
        <a  class="page-link"  href="/help-documentation/openstack">Open Stack (15)</a>
        <a href=""  class="expand rotate" ><img src="/help-documentation/img/en/arrow.svg" /></a>
      </h3>
      <ul  class="article__list slide-up-hidden" >
        <h5 class="sub__head">User Docs</h5>
        
        
        
          
          <li>
              <a class="page-link" href="/help-documentation/openstack/userdocs/launch-instance-from-volume/">How to Launch an Instance from a Volume</a>
          </li>
          
        
          
          <li>
              <a class="page-link" href="/help-documentation/openstack/userdocs/import-vhd-image-lvm/">Importing a VHD image that uses linux volume management for its root directory</a>
          </li>
          
        
          
            
            
              <li class="non-featured">
                  <a class="page-link" href="/help-documentation/openstack/userdocs/OpenStack_network_concepts/">OpenStack Network Concepts</a>
              </li>
            
          
        
          
          <li>
              <a class="page-link" href="/help-documentation/openstack/userdocs/Creating-an-Instance-with-a-Specific-Fixed-IP/">Creating an Instance with a Specific Fixed IP</a>
          </li>
          
        
          
          <li>
              <a class="page-link" href="/help-documentation/openstack/userdocs/Mitaka_CLI_notes/">OpenStack Mitaka CLI Notes</a>
          </li>
          
        
          
            
            
              <li class="non-featured">
                  <a class="page-link" href="/help-documentation/openstack/userdocs/Why-Choose-OpenStack/">Why Choose OpenStack?</a>
              </li>
            
          
        
          
            
            
              <li class="non-featured">
                  <a class="page-link" href="/help-documentation/openstack/userdocs/openstack-storage-concepts/">OpenStack Storage Concepts</a>
              </li>
            
          
        
          
          <li>
              <a class="page-link" href="/help-documentation/openstack/userdocs/Ursula_and_OpenStack/">Ursula and OpenStack</a>
          </li>
          
        
          
          <li>
              <a class="page-link" href="/help-documentation/openstack/userdocs/Creating_Instances_With_Static_IP/">How to Create An Instance With Static IP</a>
          </li>
          
        
          
          <li>
              <a class="page-link" href="/help-documentation/openstack/userdocs/quotas/">Quotas</a>
          </li>
          
        
          
          <li>
              <a class="page-link" href="/help-documentation/openstack/userdocs/How_to_Isolate_Tenants/">How to Isolate Tenants (Projects)</a>
          </li>
          
        
          
          <li>
              <a class="page-link" href="/help-documentation/openstack/userdocs/external-reference-material/">External reference materials</a>
          </li>
          
        
        <li><a href="" class="page-link view">View More ( 3 )</a></li>
      </ul>

      <ul  class="article__list slide-up-hidden" >
        <h5 class="sub__head">API</h5>
        
        
        
          
          <li>
              <a class="page-link" href="/help-documentation/openstack/api/floating-ip-address/">Creating a floating IP address using the OpenStack API</a>
          </li>
          
        
          
          <li>
              <a class="page-link" href="/help-documentation/openstack/api/openstack-api-getting-started/">Getting Started with the OpenStack API</a>
          </li>
          
        
          
            
            
              <li class="non-featured">
                  <a class="page-link" href="/help-documentation/openstack/api/OpenStack_Client_Versions/">Requirements for OpenStack client versions</a>
              </li>
            
          
        
        <li><a href="" class="page-link view">View More ( 1 )</a></li>
      </ul>
    </li>




    <li>
      <h3 class="title">
        <a  class="page-link"  href="/help-documentation/horizon">Horizon [GUI] (10)</a>
        <a href=""  class="expand rotate" ><img src="/help-documentation/img/en/arrow.svg" /></a>
      </h3>
      <ul  class="article__list slide-up-hidden" >
        
        
        
          
          <li>
              <a class="page-link" href="/help-documentation/horizon/creating-additional-networks-with-horizon/">Creating Additional Networks in OpenStack Using the Horizon Panel</a>
          </li>
          
        
          
          <li>
              <a class="page-link" href="/help-documentation/horizon/Making_Snapshots_in_Horizon/">Using Horizon for Snapshots</a>
          </li>
          
        
          
          <li>
              <a class="page-link" href="/help-documentation/horizon/allocate-floating-ip/">Allocating and Attaching a Public (Floating) IP to an Instance</a>
          </li>
          
        
          
            
            
              <li class="non-featured">
                  <a class="page-link" href="/help-documentation/horizon/create-volume-from-horizon/">Creating a volume from the Horizon dashboard</a>
              </li>
            
          
        
          
            
            
              <li class="non-featured">
                  <a class="page-link" href="/help-documentation/horizon/horizon-for-administrators/">Horizon for Administrators</a>
              </li>
            
          
        
          
            
            
              <li class="non-featured">
                  <a class="page-link" href="/help-documentation/horizon/launch-instance-from-horizon/">Launching an instance from the Horizon dashboard</a>
              </li>
            
          
        
          
            
            
              <li class="non-featured">
                  <a class="page-link" href="/help-documentation/horizon/launch-instance-from-horizon_newton/">Launching an instance from the Horizon dashboard (OpenStack Newton release)</a>
              </li>
            
          
        
          
            
            
              <li class="non-featured">
                  <a class="page-link" href="/help-documentation/horizon/set-reverse-dns/">How do I set a reverse DNS (PTR) record for an IBM Bluemix Private Cloud instance?</a>
              </li>
            
          
        
          
            
            
              <li class="non-featured">
                  <a class="page-link" href="/help-documentation/horizon/using-horizon/">Using Horizon</a>
              </li>
            
          
        
          
          <li>
              <a class="page-link" href="/help-documentation/horizon/Horizon_troubleshooting_FAQ/">Horizon Troubleshooting FAQ</a>
          </li>
          
        
      </ul>
    </li>

    <li>
      <h3 class="title">
        <a  class="page-link"  href="/help-documentation/nova">Nova [Compute] (13)</a>
        <a href=""  class="expand rotate" ><img src="/help-documentation/img/en/arrow.svg" /></a>
      </h3>
      <ul  class="article__list slide-up-hidden" >
        
        
        
          
            
            
              <li class="non-featured">
                  <a class="page-link" href="/help-documentation/nova/windows-user-and-password/">How do I set an initial username and password on a Windows instance in OpenStack?</a>
              </li>
            
          
        
          
            
            
              <li class="non-featured">
                  <a class="page-link" href="/help-documentation/nova/nova_live_migration/">Instance Live Migration</a>
              </li>
            
          
        
          
          <li>
              <a class="page-link" href="/help-documentation/nova/CLI-create-public-instance/">How to Create an Instance and Make it Available Publicly Using the Command Line</a>
          </li>
          
        
          
          <li>
              <a class="page-link" href="/help-documentation/nova/Nova_boot_speed/">What happens behind the scenes when I boot a virtual machine, and how can I make it boot faster?</a>
          </li>
          
        
          
          <li>
              <a class="page-link" href="/help-documentation/nova/Restrict_Floating_IP/">How Can I Restrict Floating IPs?</a>
          </li>
          
        
          
            
            
              <li class="non-featured">
                  <a class="page-link" href="/help-documentation/nova/config_drive_for_instances/">Can I create an instance and add files to it using config drive?</a>
              </li>
            
          
        
          
            
            
              <li class="non-featured">
                  <a class="page-link" href="/help-documentation/nova/create-vm-with-volumes/">How can I create an instance with the Nova command line client?</a>
              </li>
            
          
        
          
          <li>
              <a class="page-link" href="/help-documentation/nova/define-flavor-vcpu/">How can I define flavor vCPU topology?</a>
          </li>
          
        
          
            
            
              <li class="non-featured">
                  <a class="page-link" href="/help-documentation/nova/deploy-to-specific-hypervisor/">How to deploy an instance to a specific hypervisor node</a>
              </li>
            
          
        
          
            
            
              <li class="non-featured">
                  <a class="page-link" href="/help-documentation/nova/maximum-flavor-spec/">What is the maximum spec I can set for a flavor?</a>
              </li>
            
          
        
          
            
            
              <li class="non-featured">
                  <a class="page-link" href="/help-documentation/nova/migrate-instance/">Migrating an instance to a new cloud</a>
              </li>
            
          
        
          
          <li>
              <a class="page-link" href="/help-documentation/nova/Metadata_service_FAQ/">Metadata Service in OpenStack Neutron and Nova</a>
          </li>
          
        
          
          <li>
              <a class="page-link" href="/help-documentation/nova/hypervisor-statistics/">How can I get hypervisor statistics?</a>
          </li>
          
        
      </ul>
    </li>

    <li>
      <h3 class="title">
        <a  class="page-link"  href="/help-documentation/neutron">Neutron [Networking] (22)</a>
        <a href=""  class="expand rotate" ><img src="/help-documentation/img/en/arrow.svg" /></a>
      </h3>
      <ul  class="article__list slide-up-hidden" >
        
        
        
          
        
          
            
            
              <li class="non-featured">
                  <a class="page-link" href="/help-documentation/neutron/network_ip_availability/">How Can I Check My Network IP Availability?</a>
              </li>
            
          
        
          
          <li>
              <a class="page-link" href="/help-documentation/neutron/isolatetwoprojectnetworksconnectedtoonesharedrouter/">How can you isolate project networks connected to a shared router?</a>
          </li>
          
        
          
            
            
              <li class="non-featured">
                  <a class="page-link" href="/help-documentation/neutron/time-ip-associated-with-instance/">How can I find the time a floating IP was associated or disassociated from an instance?</a>
              </li>
            
          
        
          
            
            
              <li class="non-featured">
                  <a class="page-link" href="/help-documentation/neutron/Load_Balancing_Methods/">Load Balancing Methods</a>
              </li>
            
          
        
          
            
            
              <li class="non-featured">
                  <a class="page-link" href="/help-documentation/neutron/Multi-tier_Router_Configuration/">Multi-tier Router Configuration Within Your IBM Bluemix Private Cloud</a>
              </li>
            
          
        
          
            
            
              <li class="non-featured">
                  <a class="page-link" href="/help-documentation/neutron/set-up-dns-records/">How do I set up DNS records pointing to OpenStack instances?</a>
              </li>
            
          
        
          
            
            
              <li class="non-featured">
                  <a class="page-link" href="/help-documentation/neutron/routing_internal_traffic_between_projects/">Routing Internal Traffic Between Projects</a>
              </li>
            
          
        
          
          <li>
              <a class="page-link" href="/help-documentation/neutron/add-ip-to-instance/">Add a Specific Fixed Private IP to an Instance</a>
          </li>
          
        
          
            
            
              <li class="non-featured">
                  <a class="page-link" href="/help-documentation/neutron/configure-dns.for-instances/">Configuring DNS for Instances</a>
              </li>
            
          
        
          
          <li>
              <a class="page-link" href="/help-documentation/neutron/configure-multi-nics/">Configuring multiple network interfaces for your own cloud images</a>
          </li>
          
        
          
            
            
              <li class="non-featured">
                  <a class="page-link" href="/help-documentation/neutron/configure-ha-ip/">How to configure a highly-available IP</a>
              </li>
            
          
        
          
            
            
              <li class="non-featured">
                  <a class="page-link" href="/help-documentation/neutron/creating-virtual-networks/">Creating virtual networks on IBM Bluemix Private Cloud</a>
              </li>
            
          
        
          
            
            
              <li class="non-featured">
                  <a class="page-link" href="/help-documentation/neutron/when_create_port_fails/">When creating port failed, how could I do ?</a>
              </li>
            
          
        
          
            
            
              <li class="non-featured">
                  <a class="page-link" href="/help-documentation/neutron/How_Can_I_See_My_IPs/">How Can I See My IPs?</a>
              </li>
            
          
        
          
            
            
              <li class="non-featured">
                  <a class="page-link" href="/help-documentation/neutron/How_to_update_DNS/">How Can I Update DNS?</a>
              </li>
            
          
        
          
            
            
              <li class="non-featured">
                  <a class="page-link" href="/help-documentation/neutron/vpn-vlan-directlink/">VPN, VLAN, and Direct Link</a>
              </li>
            
          
        
          
            
            
              <li class="non-featured">
                  <a class="page-link" href="/help-documentation/neutron/BYOFIP_support/">Using BYOFIP Connectivity Between IBM Bluemix Private Cloud and a Customer Site</a>
              </li>
            
          
        
          
            
            
              <li class="non-featured">
                  <a class="page-link" href="/help-documentation/neutron/Intro_to_LBaaS/">Introduction to Load Balancer as a Service (LBaaS)</a>
              </li>
            
          
        
          
            
            
              <li class="non-featured">
                  <a class="page-link" href="/help-documentation/neutron/Security_groups_CLI/">Using the CLI to Set Up Security Groups</a>
              </li>
            
          
        
          
          <li>
              <a class="page-link" href="/help-documentation/neutron/Network_Use_Cases_White_Paper/">IBM Blue Box Network Use Cases</a>
          </li>
          
        
          
            
            
              <li class="non-featured">
                  <a class="page-link" href="/help-documentation/neutron/Where_Are_These_IPs/">Where Are the First Two IPs?</a>
              </li>
            
          
        
      </ul>
    </li>

    <li>
      <h3 class="title">
        <a  class="page-link"  href="/help-documentation/glance">Glance [Images] (6)</a>
        <a href=""  class="expand rotate" ><img src="/help-documentation/img/en/arrow.svg" /></a>
      </h3>
      <ul  class="article__list slide-up-hidden" >
        
        
        
          
        
          
          <li>
              <a class="page-link" href="/help-documentation/glance/FAQ_Working_with_Windows_Images/">Working with Windows Images FAQ</a>
          </li>
          
        
          
            
            
              <li class="non-featured">
                  <a class="page-link" href="/help-documentation/glance/compatible-glance-images/">Is there a list of official OpenStack-compatible images that I can download for use with Glance? (CentOS, Ubuntu, etc.)</a>
              </li>
            
          
        
          
            
            
              <li class="non-featured">
                  <a class="page-link" href="/help-documentation/glance/disk-capacity-constraints/">Disk Capacity Constraints</a>
              </li>
            
          
        
          
            
            
              <li class="non-featured">
                  <a class="page-link" href="/help-documentation/glance/Image_Properties_on_Power/">Optimal Settings for Glance Images on Power Compute</a>
              </li>
            
          
        
          
            
            
              <li class="non-featured">
                  <a class="page-link" href="/help-documentation/glance/imagesnapshot/">Difference Between Image and Snapshot</a>
              </li>
            
          
        
      </ul>
    </li>

    <li>
      <h3 class="title">
        <a  class="page-link"  href="/help-documentation/cinder">Cinder [Block Storage] (13)</a>
        <a href=""  class="expand rotate" ><img src="/help-documentation/img/en/arrow.svg" /></a>
      </h3>
      <ul  class="article__list slide-up-hidden" >
        
        
        
          
          <li>
              <a class="page-link" href="/help-documentation/cinder/read-only-cinder-error/">What causes read-only Cinder volumes and how can I fix them?</a>
          </li>
          
        
          
          <li>
              <a class="page-link" href="/help-documentation/cinder/cinder-volume-stuck/">Cinder Volume Stuck</a>
          </li>
          
        
          
            
            
              <li class="non-featured">
                  <a class="page-link" href="/help-documentation/cinder/alternative_method_for_volume_encryption/">Alternative Method For Block Storage Volume Encryption (using an Ubuntu Guest VM)</a>
              </li>
            
          
        
          
            
            
              <li class="non-featured">
                  <a class="page-link" href="/help-documentation/cinder/Bug_Creating_Encrypted_Volumes/">Creating Encrypted Volumes with Cinder is Not Supported</a>
              </li>
            
          
        
          
          <li>
              <a class="page-link" href="/help-documentation/cinder/Managing_block_storage/">Managing Block Storage</a>
          </li>
          
        
          
            
            
              <li class="non-featured">
                  <a class="page-link" href="/help-documentation/cinder/cli-create-volume/">Creating a volume with the command line</a>
              </li>
            
          
        
          
            
            
              <li class="non-featured">
                  <a class="page-link" href="/help-documentation/cinder/create-volume-from-snapshot/">Is creating a volume from an instance snapshot supported?</a>
              </li>
            
          
        
          
            
            
              <li class="non-featured">
                  <a class="page-link" href="/help-documentation/cinder/resize_cinder_volume/">How Can I Resize a Cinder Volume?</a>
              </li>
            
          
        
          
            
            
              <li class="non-featured">
                  <a class="page-link" href="/help-documentation/cinder/supported_volume_types/">Which Cinder Volume Types are supported in Cloud Instance?</a>
              </li>
            
          
        
          
            
            
              <li class="non-featured">
                  <a class="page-link" href="/help-documentation/cinder/Ephemeral_to_Cinder/">How to Move from Ephemeral Disk to Cinder Storage</a>
              </li>
            
          
        
          
            
            
              <li class="non-featured">
                  <a class="page-link" href="/help-documentation/cinder/volume_clone/">Can I enable volume full clone more than copy-on-write clone?</a>
              </li>
            
          
        
          
            
            
              <li class="non-featured">
                  <a class="page-link" href="/help-documentation/cinder/Force_snapshot_on_attached_volume/">How to Force a Snapshot on an Attached Volume</a>
              </li>
            
          
        
          
            
            
              <li class="non-featured">
                  <a class="page-link" href="/help-documentation/cinder/cinder-failed-connection-error/">What do I do if the Cinder client returns 'ERROR: Unable to establish connection' message and fails to connect?</a>
              </li>
            
          
        
      </ul>
    </li>

    <li>
      <h3 class="title">
        <a  class="page-link"  href="/help-documentation/keystone">Keystone [Identity] (8)</a>
        <a href=""  class="expand rotate" ><img src="/help-documentation/img/en/arrow.svg" /></a>
      </h3>
      <ul  class="article__list slide-up-hidden" >
        
        
        
          
            
            
              <li class="non-featured">
                  <a class="page-link" href="/help-documentation/keystone/oidc-federation/">OpenID Connect Federation on IBM Bluemix Private Cloud</a>
              </li>
            
          
        
          
            
            
              <li class="non-featured">
                  <a class="page-link" href="/help-documentation/keystone/saml-federation/">Keystone SAML Federation on IBM Bluemix Private Cloud</a>
              </li>
            
          
        
          
            
            
              <li class="non-featured">
                  <a class="page-link" href="/help-documentation/keystone/RBAC_Definitions/">Role-Based Access Control</a>
              </li>
            
          
        
          
            
            
              <li class="non-featured">
                  <a class="page-link" href="/help-documentation/keystone/Managing_Users_and_Projects/">Managing Users and Projects</a>
              </li>
            
          
        
          
            
            
              <li class="non-featured">
                  <a class="page-link" href="/help-documentation/keystone/k2k-federation/">Keystone to Keystone (K2K) Federation on IBM Bluemix Private Cloud</a>
              </li>
            
          
        
          
            
            
              <li class="non-featured">
                  <a class="page-link" href="/help-documentation/keystone/tenants-security-groups-keystone/">Projects and Security Groups</a>
              </li>
            
          
        
          
            
            
              <li class="non-featured">
                  <a class="page-link" href="/help-documentation/keystone/custom-domains-keystone/">Custom Domains within Keystone V3</a>
              </li>
            
          
        
          
          <li>
              <a class="page-link" href="/help-documentation/keystone/Getting_Started_with_K2K_Identity/">Getting Started with Keystone Federated Identity</a>
          </li>
          
        
      </ul>
    </li>

    <li>
      <h3 class="title">
        <a  class="page-link"  href="/help-documentation/heat">Heat [Orchestration] (7)</a>
        <a href=""  class="expand rotate" ><img src="/help-documentation/img/en/arrow.svg" /></a>
      </h3>
      <ul  class="article__list" >
        
        
        
          
        
          
          <li>
              <a class="page-link" href="/help-documentation/heat/Getting_Started_With_Heat/">Getting Started With Heat Templates</a>
          </li>
          
        
          
            
            <li>
                <a class="page-link--active"  href="/help-documentation/heat/autoscaling-with-heat/">Using Heat for autoscaling</a>
            </li>
            
          
        
          
          <li>
              <a class="page-link" href="/help-documentation/heat/Deploying_apps_with_UCD/">Deploying Applications with IBM UrbanCode Deploy and IBM Bluemix Private Cloud</a>
          </li>
          
        
          
            
            
              <li class="non-featured">
                  <a class="page-link" href="/help-documentation/heat/using_heat_for_load_balancer/">Using Heat for provisioning servers with a load balancer</a>
              </li>
            
          
        
          
            
            
              <li class="non-featured">
                  <a class="page-link" href="/help-documentation/heat/using-ucd-ucdp/">Using IBM Urban Code Deploy with IBM Bluemix Private Cloud</a>
              </li>
            
          
        
          
            
            
              <li class="non-featured">
                  <a class="page-link" href="/help-documentation/heat/using_heat_for_deployment/">Using Heat With a Self-signed Certificate</a>
              </li>
            
          
        
      </ul>
    </li>


    <li>
      <h3 class="title">
        <a  class="page-link"  href="/help-documentation/ceilometer">Ceilometer [Telemetry] (1)</a>
        <a href=""  class="expand rotate" ><img src="/help-documentation/img/en/arrow.svg" /></a>
      </h3>
      <ul  class="article__list slide-up-hidden" >
        
        
        
          
            
            
              <li class="non-featured">
                  <a class="page-link" href="/help-documentation/ceilometer/compatible-glance-images/">Is creating a volume from an instance snapshot supported?</a>
              </li>
            
          
        
      </ul>
    </li>

  </ul>
</div>


<article>

  <div class="page-container">

    <div class="main-content">
      <header class="post-header">

        <h1 class="post-title">
        

        

        Using Heat for autoscaling

        
        </h1>




        
        <div class="post-data">
          <img src='/help-documentation/img/en/avatar.png' />
          <ul class="author--info">
            <li>
              <span class="author">by Blue Box Support </span>
              <span class="dot">&#9679;</span>
              <span class="date"> May 11th, 2016</span>
            </li>
            <li>
              <span class="job-title"></span>
            </li>
            <li class="tags">
              
                <h4>Tags:</h4>
                  <ul class="tag--list">
                  
                    <li class="tag"><p>heat</p></li>
                  
                    <li class="tag"><p>autoscaling</p></li>
                  
                    <li class="tag"><p>deploy</p></li>
                  
                  </ul>
              
            </li>
          </ul>
        </div>
        
      </header>

      <div class="post-content">
        <p>OpenStack provides autoscaling features through Heat. This feature reduces the need to manually provision instance capacities in advance. You can use Heat resources to detect when a Ceilometer alarm triggers and provision or de-provision a new VM depending on the trigger. These groups of VMs must be under a load balancer which distributes the load among the VMs on the scaling group.</p>

<p>Whether you are running one instance or thousands, you can use autoscaling to detect, increase, decrease, and replace instances without manual intervention.</p>

<p>In the following examples, the following two policies are defined:</p>

<ul>
  <li>When the CPU utilization rate is above 50%, a new instance is created automatically until the number of instances reaches six.</li>
  <li>When any CPU utilization rate is below 15%, an instance is terminated until the number of instances reaches one.</li>
</ul>

<h2 id="creating-stacks">Creating stacks</h2>
<ol>
  <li>Download the <a href="../simplescale.yaml">simple scale file</a>.</li>
  <li>Log on to the Horizon dashboard with the heat_stack_owner role.</li>
  <li>Click <strong>Project</strong> -&gt; <strong>Orchestration</strong> -&gt; <strong>Stacks</strong>.</li>
  <li>Click <strong>Launch Stack</strong>.</li>
  <li>On the Select Template page, click <strong>Choose File</strong> and select the simple scale file on your local machine.</li>
  <li>Update the image ID, network ID, key pair name, and security group ID based on your cloud instance.</li>
  <li>Click <strong>Launch</strong>.</li>
</ol>

<h2 id="monitoring-stacks">Monitoring stacks</h2>
<ol>
  <li>Log on to the Horizon dashboard with the heat_stack_owner role.</li>
  <li>Click <strong>Project</strong> -&gt; <strong>Instance</strong> and find the instance created as part of the stack.</li>
  <li>Connect to the instance with SSH connection tools such as Putty.</li>
  <li>Run the <code class="highlighter-rouge">top</code> command to check CPU utilization rate. The utilization rate consumed by the dd process should be at least 99%. This triggers the CPU high utilization alarm.</li>
  <li>Wait approximately ten minutes and verify that a new instance is created as part of the stack.</li>
  <li>Log in to both instances, find the dd process, and terminate it. This triggers the CPU low utilization alarm.</li>
  <li>Wait approximately ten minutes and verify that one of the instance is terminated and only one remains.</li>
</ol>

<h2 id="removing-stacks">Removing stacks</h2>
<ol>
  <li>Log on to the Horizon dashboard with the heat_stack_owner role.</li>
  <li>Click <strong>Project</strong> -&gt; <strong>Orchestration</strong> -&gt; <strong>Stacks</strong>.</li>
  <li>Select the stack that you want to remove and click <strong>Delete</strong>.</li>
</ol>

<h2 id="an-example-of-deploying-a-wordpress-stack">An example of deploying a WordPress stack</h2>

<p>You can find an auto-scaling example template for Heat on the official <a href="https://github.com/openstack/heat-templates/tree/master/hot">OpenStack Github repository</a>. 
The following example uses a <a href="../autobalance_autoscaling.yaml">similar template</a> based on the official one, which uses a snapshot of a VM with WordPress already installed and configured over an Ubuntu operating system as a base image.</p>

<p>You need the following parameters:</p>

<figure class="highlight"><pre><code class="language-yaml" data-lang="yaml"><span class="s">parameters</span><span class="pi">:</span>
  <span class="s">image</span><span class="pi">:</span>
    <span class="s">type</span><span class="pi">:</span> <span class="s">string</span>
    <span class="s">description</span><span class="pi">:</span> <span class="s">Image used for servers</span>
    <span class="s">default</span><span class="pi">:</span> <span class="s2">"</span><span class="s">your</span><span class="nv"> </span><span class="s">image</span><span class="nv"> </span><span class="s">ID"</span>
  <span class="s">key</span><span class="pi">:</span>
    <span class="s">type</span><span class="pi">:</span> <span class="s">string</span>
    <span class="s">description</span><span class="pi">:</span> <span class="s">SSH key to connect to the servers</span>
    <span class="s">default</span><span class="pi">:</span>  <span class="s2">"</span><span class="s">your</span><span class="nv"> </span><span class="s">ssh</span><span class="nv"> </span><span class="s">ID"</span>
  <span class="s">flavor</span><span class="pi">:</span>
    <span class="s">type</span><span class="pi">:</span> <span class="s">string</span>
    <span class="s">description</span><span class="pi">:</span> <span class="s">flavor used by the web servers</span>
    <span class="s">default</span><span class="pi">:</span> <span class="s">m1.small</span>
  <span class="s">network</span><span class="pi">:</span>
    <span class="s">type</span><span class="pi">:</span> <span class="s">string</span>
    <span class="s">description</span><span class="pi">:</span> <span class="s">Network used by the server</span>
    <span class="s">default</span><span class="pi">:</span>  <span class="s2">"</span><span class="s">your</span><span class="nv"> </span><span class="s">private</span><span class="nv"> </span><span class="s">network</span><span class="nv"> </span><span class="s">ID"</span>
  <span class="s">subnet_id</span><span class="pi">:</span>
    <span class="s">type</span><span class="pi">:</span> <span class="s">string</span>
    <span class="s">description</span><span class="pi">:</span> <span class="s">subnet on which the load balancer will be located</span>
    <span class="s">default</span><span class="pi">:</span>  <span class="s2">"</span><span class="s">your</span><span class="nv"> </span><span class="s">subnet</span><span class="nv"> </span><span class="s">ID</span><span class="nv"> </span><span class="s">on</span><span class="nv"> </span><span class="s">the</span><span class="nv"> </span><span class="s">private</span><span class="nv"> </span><span class="s">network"</span>
  <span class="s">external_network_id</span><span class="pi">:</span>
    <span class="s">type</span><span class="pi">:</span> <span class="s">string</span>
    <span class="s">description</span><span class="pi">:</span> <span class="s">UUID of a Neutron external network</span>
    <span class="s">default</span><span class="pi">:</span>  <span class="s2">"</span><span class="s">your</span><span class="nv"> </span><span class="s">public</span><span class="nv"> </span><span class="s">network</span><span class="nv"> </span><span class="s">ID"</span>
<span class="s">resources</span><span class="pi">:</span></code></pre></figure>

<p>The first resource you will provision is the health monitor configuration that will check the VMs under the load balancer. If the VM is down, the load balancer will not send traffic to it. Create the pool using the health monitor and specifying the protocol, the network and subnet, the algorithm to use for distributing the traffic, and the port that will receive the traffic on the virtual IP. Finally, create the load balancer using this pool.</p>

<ul>
  <li>Create the health monitor, pool, and load balancer:</li>
</ul>

<figure class="highlight"><pre><code class="language-yaml" data-lang="yaml"><span class="s">monitor</span><span class="pi">:</span>
  <span class="s">type</span><span class="pi">:</span> <span class="s">OS::Neutron::LBaaS::HealthMonitor</span>
  <span class="s">properties</span><span class="pi">:</span>
    <span class="s">delay</span><span class="pi">:</span> <span class="s">3</span>
    <span class="s">type</span><span class="pi">:</span> <span class="s">PING</span>
    <span class="s">timeout</span><span class="pi">:</span> <span class="s">3</span>
    <span class="s">max_retries</span><span class="pi">:</span> <span class="s">3</span>
    <span class="s">pool</span><span class="pi">:</span> <span class="pi">{</span> <span class="nv">get_resource</span><span class="pi">:</span> <span class="nv">pool</span> <span class="pi">}</span>

<span class="s">pool</span><span class="pi">:</span>
  <span class="s">type</span><span class="pi">:</span> <span class="s">OS::Neutron::LBaaS::Pool</span>
  <span class="s">properties</span><span class="pi">:</span>
    <span class="s">lb_algorithm</span><span class="pi">:</span> <span class="s">ROUND_ROBIN</span>
    <span class="s">protocol</span><span class="pi">:</span> <span class="s">HTTP</span>
    <span class="s">listener</span><span class="pi">:</span> <span class="pi">{</span> <span class="nv">get_resource</span><span class="pi">:</span> <span class="nv">listener</span> <span class="pi">}</span>

<span class="s">listener</span><span class="pi">:</span>
  <span class="s">type</span><span class="pi">:</span> <span class="s">OS::Neutron::LBaaS::Listener</span>
  <span class="s">properties</span><span class="pi">:</span>
    <span class="s">loadbalancer</span><span class="pi">:</span> <span class="pi">{</span> <span class="nv">get_resource</span><span class="pi">:</span> <span class="nv">lb</span> <span class="pi">}</span>
    <span class="s">protocol</span><span class="pi">:</span> <span class="s">HTTP</span>
    <span class="s">protocol_port</span><span class="pi">:</span> <span class="s">80</span>

<span class="s">lb</span><span class="pi">:</span>
  <span class="s">type</span><span class="pi">:</span> <span class="s">OS::Neutron::LBaaS::LoadBalancer</span>
  <span class="s">properties</span><span class="pi">:</span>
    <span class="s">vip_subnet</span><span class="pi">:</span> <span class="pi">{</span> <span class="nv">get_param</span><span class="pi">:</span>  <span class="nv">subnet_id</span> <span class="pi">}</span></code></pre></figure>

<ul>
  <li>Associate a public IP for the load balancer so that it can be accessed from the Internet. Use the following syntax to create a floating IP for the load balancer:</li>
</ul>

<figure class="highlight"><pre><code class="language-yaml" data-lang="yaml"><span class="s">lb_floating</span><span class="pi">:</span>
  <span class="s">type</span><span class="pi">:</span> <span class="s">OS::Neutron::FloatingIP</span>
  <span class="s">properties</span><span class="pi">:</span>
    <span class="s">floating_network_id</span><span class="pi">:</span> <span class="pi">{</span><span class="nv">get_param</span><span class="pi">:</span> <span class="nv">external_network_id</span><span class="pi">}</span>
    <span class="s">port_id</span><span class="pi">:</span> <span class="pi">{</span><span class="nv">get_attr</span><span class="pi">:</span> <span class="pi">[</span><span class="nv">lb</span><span class="pi">,</span> <span class="nv">vip_port_id</span><span class="pi">]}</span></code></pre></figure>

<ul>
  <li>Use the following syntax to create the auto-scaling group (VMs):</li>
</ul>

<figure class="highlight"><pre><code class="language-yaml" data-lang="yaml"><span class="s">asg</span><span class="pi">:</span>
    <span class="s">type</span><span class="pi">:</span> <span class="s">OS::Heat::AutoScalingGroup</span>
    <span class="s">properties</span><span class="pi">:</span>
      <span class="s">min_size</span><span class="pi">:</span> <span class="s">1</span>
      <span class="s">max_size</span><span class="pi">:</span> <span class="s">3</span>
      <span class="s">resource</span><span class="pi">:</span>
        <span class="s">type</span><span class="pi">:</span> <span class="s">lb_server.yaml</span>
        <span class="s">properties</span><span class="pi">:</span>
          <span class="s">flavor</span><span class="pi">:</span> <span class="pi">{</span><span class="nv">get_param</span><span class="pi">:</span> <span class="nv">flavor</span><span class="pi">}</span>
          <span class="s">image</span><span class="pi">:</span> <span class="pi">{</span><span class="nv">get_param</span><span class="pi">:</span> <span class="nv">image</span><span class="pi">}</span>
          <span class="s">key_name</span><span class="pi">:</span> <span class="pi">{</span><span class="nv">get_param</span><span class="pi">:</span> <span class="nv">key</span><span class="pi">}</span>
          <span class="s">network</span><span class="pi">:</span> <span class="pi">{</span><span class="nv">get_param</span><span class="pi">:</span> <span class="nv">network</span><span class="pi">}</span>
          <span class="s">pool_id</span><span class="pi">:</span> <span class="pi">{</span><span class="nv">get_resource</span><span class="pi">:</span> <span class="nv">pool</span><span class="pi">}</span>
          <span class="s">metadata</span><span class="pi">:</span> <span class="pi">{</span><span class="s2">"</span><span class="s">metering.stack"</span><span class="pi">:</span> <span class="pi">{</span><span class="nv">get_param</span><span class="pi">:</span> <span class="s2">"</span><span class="s">OS::stack_id"</span><span class="pi">}}</span>
          <span class="s">subnet</span><span class="pi">:</span> <span class="pi">{</span><span class="nv">get_param</span><span class="pi">:</span>  <span class="nv">subnet_id</span><span class="pi">}</span>
          <span class="s">user_data</span><span class="pi">:</span>
            <span class="s">str_replace</span><span class="pi">:</span>
              <span class="s">template</span><span class="pi">:</span> <span class="pi">|</span>
                <span class="no">#!/bin/bash -v</span>
                <span class="no">sudo mysql -uroot -p"password" &lt;&lt;EOF</span>
                <span class="no">use wordpress;</span>
                <span class="no">update wp_options set option_value='http://$ip/wordpress' where option_id = 2;</span>
                <span class="no">update wp_options set option_value='http://$ip/wordpress' where option_id = 1;</span>
                <span class="no">EOF</span>

              <span class="s">params</span><span class="pi">:</span>
                <span class="s">$ip</span><span class="pi">:</span>  <span class="pi">{</span> <span class="nv">get_attr</span><span class="pi">:</span> <span class="pi">[</span><span class="nv">lb_floating</span><span class="pi">,</span> <span class="nv">floating_ip_address</span><span class="pi">]</span> <span class="pi">}</span><span class="err">		</span></code></pre></figure>

<p>Use a Heat specific resource to define the scaling group: size and image that will be used to scale. You must make some changes on the database as every time the saved image is initialized, the public IP must be updated on the database. Use the user data to do this. See another file <a href="../lb_server.yaml">lb_server.yaml</a>.</p>

<ul>
  <li>Using specific Heat resources, define both up and down scaling policies. Use the following syntax to create scaling policies:</li>
</ul>

<figure class="highlight"><pre><code class="language-yaml" data-lang="yaml"><span class="s">web_server_scaleup_policy</span><span class="pi">:</span>
    <span class="s">type</span><span class="pi">:</span> <span class="s">OS::Heat::ScalingPolicy</span>
    <span class="s">properties</span><span class="pi">:</span>
      <span class="s">adjustment_type</span><span class="pi">:</span> <span class="s">change_in_capacity</span>
      <span class="s">auto_scaling_group_id</span><span class="pi">:</span> <span class="pi">{</span><span class="nv">get_resource</span><span class="pi">:</span> <span class="nv">asg</span><span class="pi">}</span>
      <span class="s">cooldown</span><span class="pi">:</span> <span class="s">60</span>
      <span class="s">scaling_adjustment</span><span class="pi">:</span> <span class="s">1</span>
<span class="s">web_server_scaledown_policy</span><span class="pi">:</span>
    <span class="s">type</span><span class="pi">:</span> <span class="s">OS::Heat::ScalingPolicy</span>
    <span class="s">properties</span><span class="pi">:</span>
      <span class="s">adjustment_type</span><span class="pi">:</span> <span class="s">change_in_capacity</span>
      <span class="s">auto_scaling_group_id</span><span class="pi">:</span> <span class="pi">{</span><span class="nv">get_resource</span><span class="pi">:</span> <span class="nv">asg</span><span class="pi">}</span>
      <span class="s">cooldown</span><span class="pi">:</span> <span class="s">60</span>
      <span class="s">scaling_adjustment</span><span class="pi">:</span> <span class="s">-1</span></code></pre></figure>

<ul>
  <li>Use Ceilometer to establish the alarms (both high and low) for the auto-scaling group for a specific metric. Use the following syntax to create Ceilometer alarms:</li>
</ul>

<figure class="highlight"><pre><code class="language-yaml" data-lang="yaml"> <span class="s">cpu_alarm_high</span><span class="pi">:</span>
    <span class="s">type</span><span class="pi">:</span> <span class="s">OS::Ceilometer::Alarm</span>
    <span class="s">properties</span><span class="pi">:</span>
      <span class="s">description</span><span class="pi">:</span> <span class="s">Scale-up if the average CPU &gt; 50% for 1 minute</span>
      <span class="s">meter_name</span><span class="pi">:</span> <span class="s">cpu_util</span>
      <span class="s">statistic</span><span class="pi">:</span> <span class="s">avg</span>
      <span class="s">period</span><span class="pi">:</span> <span class="s">60</span>
      <span class="s">evaluation_periods</span><span class="pi">:</span> <span class="s">1</span>
      <span class="s">threshold</span><span class="pi">:</span> <span class="s">50</span>
      <span class="s">alarm_actions</span><span class="pi">:</span>
        <span class="pi">-</span> <span class="pi">{</span><span class="nv">get_attr</span><span class="pi">:</span> <span class="pi">[</span><span class="nv">web_server_scaleup_policy</span><span class="pi">,</span> <span class="nv">alarm_url</span><span class="pi">]}</span>
      <span class="s">matching_metadata</span><span class="pi">:</span> <span class="pi">{</span><span class="s1">'</span><span class="s">metadata.user_metadata.stack'</span><span class="pi">:</span> <span class="pi">{</span><span class="nv">get_param</span><span class="pi">:</span> <span class="s2">"</span><span class="s">OS::stack_id"</span><span class="pi">}}</span>
      <span class="s">comparison_operator</span><span class="pi">:</span> <span class="s">gt</span>
  <span class="s">cpu_alarm_low</span><span class="pi">:</span>
    <span class="s">type</span><span class="pi">:</span> <span class="s">OS::Ceilometer::Alarm</span>
    <span class="s">properties</span><span class="pi">:</span>
      <span class="s">description</span><span class="pi">:</span> <span class="s">Scale-down if the average CPU &lt; 15% for 10 minutes</span>
      <span class="s">meter_name</span><span class="pi">:</span> <span class="s">cpu_util</span>
      <span class="s">statistic</span><span class="pi">:</span> <span class="s">avg</span>
      <span class="s">period</span><span class="pi">:</span> <span class="s">600</span>
      <span class="s">evaluation_periods</span><span class="pi">:</span> <span class="s">1</span>
      <span class="s">threshold</span><span class="pi">:</span> <span class="s">15</span>
      <span class="s">alarm_actions</span><span class="pi">:</span>
        <span class="pi">-</span> <span class="pi">{</span><span class="nv">get_attr</span><span class="pi">:</span> <span class="pi">[</span><span class="nv">web_server_scaledown_policy</span><span class="pi">,</span> <span class="nv">alarm_url</span><span class="pi">]}</span>
      <span class="s">matching_metadata</span><span class="pi">:</span> <span class="pi">{</span><span class="s1">'</span><span class="s">metadata.user_metadata.stack'</span><span class="pi">:</span> <span class="pi">{</span><span class="nv">get_param</span><span class="pi">:</span> <span class="s2">"</span><span class="s">OS::stack_id"</span><span class="pi">}}</span>
      <span class="s">comparison_operator</span><span class="pi">:</span> <span class="s">lt</span></code></pre></figure>

<p>In the <a href="../lb_server.yaml">lb_server.yaml</a> file, define the image to initialize each time that the alarm triggers. These are the parameters that will be filled from the original template (the official one):</p>

<figure class="highlight"><pre><code class="language-yaml" data-lang="yaml"><span class="s">parameters</span><span class="pi">:</span>
  <span class="s">image</span><span class="pi">:</span>
    <span class="s">type</span><span class="pi">:</span> <span class="s">string</span>
    <span class="s">description</span><span class="pi">:</span> <span class="s">Image used for servers</span>
  <span class="s">key_name</span><span class="pi">:</span>
    <span class="s">type</span><span class="pi">:</span> <span class="s">string</span>
    <span class="s">description</span><span class="pi">:</span> <span class="s">SSH key to connect to the servers</span>
  <span class="s">flavor</span><span class="pi">:</span>
    <span class="s">type</span><span class="pi">:</span> <span class="s">string</span>
    <span class="s">description</span><span class="pi">:</span> <span class="s">flavor used by the servers</span>
  <span class="s">pool_id</span><span class="pi">:</span>
    <span class="s">type</span><span class="pi">:</span> <span class="s">string</span>
    <span class="s">description</span><span class="pi">:</span> <span class="s">Pool to contact</span>
  <span class="s">user_data</span><span class="pi">:</span>
    <span class="s">type</span><span class="pi">:</span> <span class="s">string</span>
    <span class="s">description</span><span class="pi">:</span> <span class="s">Server user_data</span>
  <span class="s">metadata</span><span class="pi">:</span>
    <span class="s">type</span><span class="pi">:</span> <span class="s">json</span>
  <span class="s">network</span><span class="pi">:</span>
    <span class="s">type</span><span class="pi">:</span> <span class="s">string</span>
    <span class="s">description</span><span class="pi">:</span> <span class="s">Network used by the server</span>
  <span class="s">subnet</span><span class="pi">:</span>
    <span class="s">type</span><span class="pi">:</span> <span class="s">string</span>
    <span class="s">description</span><span class="pi">:</span> <span class="s">subnet on which server will be located</span>
    <span class="s">default</span><span class="pi">:</span>  <span class="s2">"</span><span class="s">your</span><span class="nv"> </span><span class="s">subnet</span><span class="nv"> </span><span class="s">ID</span><span class="nv"> </span><span class="s">on</span><span class="nv"> </span><span class="s">the</span><span class="nv"> </span><span class="s">private</span><span class="nv"> </span><span class="s">network"</span></code></pre></figure>

<ul>
  <li>The first resource is the Nova server that you will initialize from a specific image. In our example, this is Ubuntu 14.04 with WordPress already installed and configured:</li>
</ul>

<figure class="highlight"><pre><code class="language-yaml" data-lang="yaml"><span class="s">resources</span><span class="pi">:</span>
  <span class="s">server</span><span class="pi">:</span>
    <span class="s">type</span><span class="pi">:</span> <span class="s">OS::Nova::Server</span>
    <span class="s">properties</span><span class="pi">:</span>
      <span class="s">flavor</span><span class="pi">:</span> <span class="pi">{</span><span class="nv">get_param</span><span class="pi">:</span> <span class="nv">flavor</span><span class="pi">}</span>
      <span class="s">image</span><span class="pi">:</span> <span class="pi">{</span><span class="nv">get_param</span><span class="pi">:</span> <span class="nv">image</span><span class="pi">}</span>
      <span class="s">key_name</span><span class="pi">:</span> <span class="pi">{</span><span class="nv">get_param</span><span class="pi">:</span> <span class="nv">key_name</span><span class="pi">}</span>
      <span class="s">metadata</span><span class="pi">:</span> <span class="pi">{</span><span class="nv">get_param</span><span class="pi">:</span> <span class="nv">metadata</span><span class="pi">}</span>
      <span class="s">user_data</span><span class="pi">:</span> <span class="pi">{</span><span class="nv">get_param</span><span class="pi">:</span> <span class="nv">user_data</span><span class="pi">}</span>
      <span class="s">user_data_format</span><span class="pi">:</span> <span class="s">RAW</span>
      <span class="s">networks</span><span class="pi">:</span> <span class="pi">[{</span><span class="nv">network</span><span class="pi">:</span> <span class="pi">{</span><span class="nv">get_param</span><span class="pi">:</span> <span class="nv">network</span><span class="pi">}</span> <span class="pi">}]</span></code></pre></figure>

<ul>
  <li>The last resource for this template is a pool member in Neutron that will add the IP of the new server that was initialized to the pool on the load balancer:</li>
</ul>

<figure class="highlight"><pre><code class="language-yaml" data-lang="yaml"><span class="s">member</span><span class="pi">:</span>
    <span class="s">type</span><span class="pi">:</span> <span class="s">OS::Neutron::LBaaS::PoolMember</span>
    <span class="s">properties</span><span class="pi">:</span>
      <span class="s">pool</span><span class="pi">:</span> <span class="pi">{</span><span class="nv">get_param</span><span class="pi">:</span> <span class="nv">pool_id</span><span class="pi">}</span>
      <span class="s">address</span><span class="pi">:</span> <span class="pi">{</span><span class="nv">get_attr</span><span class="pi">:</span> <span class="pi">[</span><span class="nv">server</span><span class="pi">,</span> <span class="nv">first_address</span><span class="pi">]}</span>
      <span class="s">protocol_port</span><span class="pi">:</span> <span class="s">80</span>
      <span class="s">subnet</span><span class="pi">:</span> <span class="pi">{</span> <span class="nv">get_param</span><span class="pi">:</span> <span class="nv">subnet</span> <span class="pi">}</span></code></pre></figure>

<h2 id="process-diagrams">Process diagrams</h2>
<p>The following diagram shows the process when you launch the Heat stack:</p>

<p><img src="/help-documentation/img/en/auto-scale_1.png" alt="This figure depicts the process when you launch the Heat stack." /></p>

<p>When the VM reaches the high CPU load limit that you set, the alarm in Ceilometer triggers and a new VM is initialized. This diagram shows the process:</p>

<p><img src="/help-documentation/img/en/auto-scale_2.png" alt="This figure depicts the process when the VM reaches the high CPU limit." /></p>

<p>The same process occurs when a VM reaches the low CPU load limit as shown in this diagram:</p>

<p><img src="/help-documentation/img/en/auto-scale_3.png" alt="This figure depicts the process when the VM reaches the low CPU limit." /></p>

      </div>
    </div>

  </div>
</article>

      </div>
    </div>

    <footer class="site-footer">

  <div class="footer__wrapper--light">

    <ul class="footer--nav">
      <li class="footer--nav__header">
        <a href="https://www.ibm.com/cloud-computing/bluemix/bluemix-private-cloud">Products</a>
      </li>
      <li class="footer--nav__item">
        <a href="https://www.ibm.com/cloud-computing/bluemix/bluemix-private-cloud" class="nav--item__link">Bluemix Private Cloud</a>
      </li>
      <li class="footer--nav__item">
        <a href="https://www.ibm.com/cloud-computing/bluemix/private-cloud-local" class="nav--item__link">Private Cloud Local</a>
      </li>
      <li class="footer--nav__item">
        <a href="https://www.ibm.com/cloud-computing/bluemix/private-cloud-contact-us" class="nav--item__link">Sales</a>
      </li>
      <li class="footer--nav__item">
        <a href="https://www.ibm.com/cloud-computing/bluemix/private-cloud-faq" class="nav--item__link">FAQs</a>
      </li>
    
    </ul>

    <ul class="footer--nav">
      <li class="footer--nav__header">
        <a href="https://www.ibm.com/cloud-computing/bluemix/bluemix-private-cloud">Our Story</a>
      </li>
 <li class="footer--nav__item">
        <a href="https://github.com/blueboxgroup?cm_mc_uid=04946053248414876234663&cm_mc_sid_50200000=1489010497" class="nav--item__link">On GitHub</a>
      </li>
      <li class="footer--nav__item">
        <a href="https://blueboxstatus.com/" class="nav--item__link">System Status</a>
      </li>
      <li class="footer--nav__item">
        <a href="https://support.bluebox.net/" class="nav--item__link">Support</a>
      </li>
      <li class="footer--nav__item">
        <a href="https://support.bluebox.net/" class="nav--item__link">Box Panel</a>
      </li>
    </ul>

    <ul class="footer--nav">
      <li class="footer--nav__header">
        <a href="https://www.ibm.com/cloud-computing/bluemix/bluemix-private-cloud">Resources
        </a>
      </li>
      <li class="footer--nav__item">
        <a href="https://www.ibm.com/cloud-computing/bluemix/bluemix-private-cloud">Case Studies</a>
      </li>
      <li class="footer--nav__item">
        <a href="https://www.ibm.com/cloud-computing/bluemix/bluemix-private-cloud" class="nav--item__link">Videos</a>
      </li>
      <li class="footer--nav__item">
        <a href="https://www.ibm.com/cloud-computing/bluemix/bluemix-private-cloud" class="nav--item__link">News</a>
      </li>
    </ul>

    <ul class="footer--nav">
      <li class="footer--nav__header">
        <a href="hhttps://www.ibm.com/blogs/bluemix/">Recent Blog Posts</a>
      </li>
      <li class="footer--nav__item">
        <a href="https://www.ibm.com/blogs/bluemix/2016/07/the-power-of-openstack/" class="nav--item__link">The Power of OpenStack</a>
      </li>
      <li class="footer--nav__item">
        <a href="https://www.ibm.com/blogs/bluemix/2016/08/blue-box-storage-models-explained/" class="nav--item__link">IBM Bluemix Private Cloud Storage Models</a>
      </li>
      <li class="footer--nav__item">
        <a href="https://www.blueboxcloud.com/insight/blog-article/github-ibm-com-running-on-blue-box" class="nav--item__link">IBM Github Runs on Bluemix Private Cloud</a>
      </li>
      <li class="footer--nav__item">
        <a href="https://www.ibm.com/blogs/bluemix/2016/10/building-up-to-openstack/" class="nav--item__link">Building up to OpenStack</a>
      </li>
      <li class="footer--nav__item">
        <a href="https://www.ibm.com/blogs/bluemix/2016/07/keystone-to-keystone-federated-identity-on-blue-box-cloud/" class="nav--item__link">Get Started with Keystone Federation</a>
      </li>
    </ul>
  </div>
  <div class="footer__wrapper--dark">
    <ul class="footer--list">
      <li class="list--item">
        <a href="https://www.facebook.com/BlueBoxGroup/" class="list--item__link">Facebook</a>
      </li>
      <li class="list--item">
        <a href="https://twitter.com/bluebox?ref_src=twsrc%5Egoogle%7Ctwcamp%5Eserp%7Ctwgr%5Eauthor" class="list--item__link">Twitter</a>
      </li>
      <li class="list--item">
        <a href="https://www.linkedin.com/company/blue-box-group" class="list--item__link">LinkedIn</a>
      </li>
      <li class="list--item">
        <a href="https://plus.google.com/+BlueBoxSeattle/posts" class="list--item__link">Google +</a>
      </li>
      <li class="list--item">
        <a href="https://github.com/blueboxgroup" class="list--item__link">GitHub</a>
      </li>
    </ul>

    <ul class="footer--list">
      <li class="list--item">
        <a href="https://www.ibm.com/cloud-computing/bluemix/private-cloud-contact-us" class="list--item__link">Contact</a>
      </li>
      <li class="list--item">
        <a href="https://www.ibm.com/cloud-computing/bluemix/bluemix-private-cloud" class="list--item__link">Legal</a>
      </li>
      <li class="list--item">
        <a href="https://www.ibm.com/cloud-computing/bluemix/bluemix-private-cloud" class="list--item__link">Privacy Policy</a>
      </li>
      <li class="list--item">
        <a href="https://www.ibm.com/cloud-computing/bluemix/bluemix-private-cloud" class="list--item__link">Terms and Conditions</a>
      </li>

    </ul>
  </div>
  <div class="footer__wrapper--black">
    <p>
        &copy; 2017 IBM Bluemix
    </p>
  </div>
</footer>



    <script src="/help-documentation/js/vendor/simple-jekyll-search.js" type="text/javascript"></script>


    <script>
        SimpleJekyllSearch({
          searchInput: document.getElementById('search-input'),
          resultsContainer: document.getElementById('results-container'),
          json: '/help-documentation/search.json',
          searchResultTemplate: '<li class="search-item"><a href="{url}" class="item-title">{title}</a><ul class="tag--list">{tags}</ul></li>'
        });
    </script>
  <script src="/help-documentation/js/scripts.js"></script>

  </body>

</html>
