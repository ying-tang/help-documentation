<!DOCTYPE html>
<html>

  <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <title>インスタンスでの OpenVPN サーバーのセットアップ</title>
  <meta name="description" content="社内の Bluemix Private Cloud インスタンスに接続する必要があるけれども、使用可能な浮動 IP アドレスがない、あるいはそれらの仮想マシンをインターネット上に配置したくない場合、1 つの手段として、要塞ホストを設定し、そこで OpenVPN を実行するという方法があります。このすることで、この...">

  <link rel="stylesheet" href="/help-documentation/css/main.css">
  <link rel="canonical" href="/help-documentation/ja/gettingstarted/commontech/openvpn-setup/">
  <link rel="alternate" type="application/rss+xml" title="Blue Box Help" href="/help-documentation/ja/feed.xml">
  
  <style>
   .site-header img:first-child {
       height: 72px;
}
</style>
  
</head>


  <body>

  
    <header class="site-header">

  <div class="header-wrapper">

    <a class="site-title" href="/help-documentation/ja/"><img src="/help-documentation/img/ja/Bluemix-logo-UI.svg" alt="" height="72px"></a>

    <div class="search--pageview">

  <div class="full-view__search hide">
    <a href="" class="x hide">X</a>
    <ul id="results-container"></ul>
    <ul class="results--container"></ul>

  </div>
  <div class="input-container">
    <label for="search__fullview" class="hide search--label">Search IBM Bluemix Private Cloud Help</label>
    <input type="text" id="search-input" placeholder="" name="search" class="search__minview--page">
    <img src="/help-documentation/img/ja/search.svg" class="search-icon" />
  </div>
</div>


    <a href="mailto:llundquist@us.ibm.com" class="header--request">
      <p>
        Submit A Request
      </p>
      <img src="/help-documentation/img/ja/user.svg">
    </a>
    <a id="nav-toggle" href="#"><span></span></a>

    <div>
  
    
      <a  href=" /help-documentation/gettingstarted/commontech/openvpn-setup/ ">en</a> |
    
      <a  href=" /help-documentation/fr/gettingstarted/commontech/openvpn-setup/ ">fr</a> |
    
      <a  href=" /help-documentation/de/gettingstarted/commontech/openvpn-setup/ ">de</a> |
    
      <a style="font-weight: bold;" href=" /help-documentation/ja/gettingstarted/commontech/openvpn-setup/ ">ja</a> |
    
      <a  href=" /help-documentation/zh_CN/gettingstarted/commontech/openvpn-setup/ ">zh_CN</a> |
    
      <a  href=" /help-documentation/zh_TW/gettingstarted/commontech/openvpn-setup/ ">zh_TW</a> |
    
      <a  href=" /help-documentation/pt_BR/gettingstarted/commontech/openvpn-setup/ ">pt_BR</a> |
    
  
</div>

  </div>

</header>

  

  
  <div class="page-content">
  

      <div class="main-wrapper">
        
<div class="sidebar sidebar--toggled">
  <ul class="sidebar__nav">
    <li>
      <h3 class="title">
        
        
        
        <a  class="page-link"  href="/help-documentation/ja/gettingstarted">Getting Started (41)</a>
        <a href=""  class="expand rotate" ><img src="/help-documentation/img/ja/arrow.svg" /></a>
      </h3>
      <ul  class="article__list slide-up-hidden" >
        <h5 class="sub__head">Common Technical Questions</h5>
        
        
        
          
          <li>
              <a class="page-link" href="/help-documentation/ja/gettingstarted/commontech/connect-to-openvpn-server/">OpenVPN サーバーへの接続</a>
          </li>
          
        
          
          <li>
              <a class="page-link--active"  href="/help-documentation/ja/gettingstarted/commontech/openvpn-setup/">インスタンスでの OpenVPN サーバーのセットアップ</a>
          </li>
          
        
          
            
            
              <li class="hidden non-featured">
                  <a class="page-link" href="/help-documentation/ja/gettingstarted/commontech/Customer_3.1.1_Point_Release/">Notas sobre a liberação do ponto 3.1.1 para cliente</a>
              </li>
            
          
        
          
          <li>
              <a class="page-link" href="/help-documentation/ja/gettingstarted/commontech/blue-box-cloud-components/">Bluemix Private Cloud コンポーネント</a>
          </li>
          
        
          
          <li>
              <a class="page-link" href="/help-documentation/ja/gettingstarted/commontech/detaching-volume/">ボリュームを切り離す前に何をすればよいですか?</a>
          </li>
          
        
          
            
            
              <li class="hidden non-featured">
                  <a class="page-link" href="/help-documentation/ja/gettingstarted/commontech/Customer_3.1.0_Release_Notes/">Notas sobre a liberação 3.1.0</a>
              </li>
            
          
        
          
          <li>
              <a class="page-link" href="/help-documentation/ja/gettingstarted/commontech/Customer_4.0.0.0r_Release_Notes/">Notas sobre a liberação 4.0.0.0r</a>
          </li>
          
        
          
          <li>
              <a class="page-link" href="/help-documentation/ja/gettingstarted/commontech/FAQ/">技術 FAQ</a>
          </li>
          
        
          
          <li>
              <a class="page-link" href="/help-documentation/ja/gettingstarted/commontech/python-environment-primer/">python 仮想環境への取り組み: 開発者の手引き</a>
          </li>
          
        
          
            
            
              <li class="hidden non-featured">
                  <a class="page-link" href="/help-documentation/ja/gettingstarted/commontech/RHOSP_Product_Overview/">IBM Bluemix Private Cloud with Red Hat - 製品概要</a>
              </li>
            
          
        
          
            
            
              <li class="hidden non-featured">
                  <a class="page-link" href="/help-documentation/ja/gettingstarted/commontech/Building_Blocks/">IBM Bluemix Private Cloud ビルディング・ブロック (Community Edition)</a>
              </li>
            
          
        
          
            
            
              <li class="hidden non-featured">
                  <a class="page-link" href="/help-documentation/ja/gettingstarted/commontech/RHOSP_Building_Blocks/">IBM Bluemix Private Cloud with Red Hat 用のビルディング・ブロック</a>
              </li>
            
          
        
          
            
            
              <li class="hidden non-featured">
                  <a class="page-link" href="/help-documentation/ja/gettingstarted/commontech/general_product_overview/">一般的な製品概要</a>
              </li>
            
          
        
          
            
            
              <li class="hidden non-featured">
                  <a class="page-link" href="/help-documentation/ja/gettingstarted/commontech/Instance_Resize/">インスタンスのサイズ変更 (非ライブ)</a>
              </li>
            
          
        
          
            
            
              <li class="hidden non-featured">
                  <a class="page-link" href="/help-documentation/ja/gettingstarted/commontech/Connecting_Clouds_with_SoftLayer/">プライベート・ネットワークの使用による複数のクラウド環境間でのネットワーク接続のセットアップ</a>
              </li>
            
          
        
          
            
            
              <li class="hidden non-featured">
                  <a class="page-link" href="/help-documentation/ja/gettingstarted/commontech/Windows_License_Activation/">Windows アクティベーションのためのお客様ガイド</a>
              </li>
            
          
        
        <li><a href="" class="page-link view">View More ( 9 )</a></li>
      </ul>
      
      <ul  class="article__list slide-up-hidden" >
        <h5 class="sub__head">Common Administrative Questions</h5>
        
        
        
          
          <li>
              <a class="page-link" href="/help-documentation/ja/gettingstarted/commonadmin/view-my-bill/">請求書を確認するにはどうすればよいですか?</a>
          </li>
          
        
          
          <li>
              <a class="page-link" href="/help-documentation/ja/gettingstarted/commonadmin/adding-removing-subscribers/">チケットへのサブスクライバーの追加または削除</a>
          </li>
          
        
          
          <li>
              <a class="page-link" href="/help-documentation/ja/gettingstarted/commonadmin/report-issue/">問題を報告するにはどうすればよいですか?</a>
          </li>
          
        
          
          <li>
              <a class="page-link" href="/help-documentation/ja/gettingstarted/commonadmin/escalating-a-ticket/">チケットをエスカレートするにはどうすればよいですか?</a>
          </li>
          
        
          
            
            
              <li class="hidden non-featured">
                  <a class="page-link" href="/help-documentation/ja/gettingstarted/commonadmin/status-pages/">Bluemix Private Cloud の状況ページ</a>
              </li>
            
          
        
          
            
            
              <li class="hidden non-featured">
                  <a class="page-link" href="/help-documentation/ja/gettingstarted/commonadmin/Transferring_A_Domain_From_Blue_Box/">Blue Box からのドメインの転送</a>
              </li>
            
          
        
        <li><a href="" class="page-link view">View More ( 2 )</a></li>
      </ul>
      
      <ul  class="article__list slide-up-hidden" >
        <h5 class="sub__head">User Guides</h5>
        
        
          
             
         
             
         
             
         
             
                
                  
                  <li class="hidden non-featured">
                    <a class="page-link" href="/help-documentation/ja/gettingstarted/userguides/Box_Panel/">Box Panel ユーザー・ガイド</a>
                  </li>
              
             
         
             
                <li>
                <a class="page-link" href="/help-documentation/ja/gettingstarted/userguides/Eternal_Blue-ish_Triangle/">Box Panel、サイト・コントローラー、および IBM Bluemix Private Cloud Local</a>
                </li>
              
         
             
                <li>
                <a class="page-link" href="/help-documentation/ja/gettingstarted/userguides/qemu_article/">OpenStack の構築 — QEMU とクラウド</a>
                </li>
              
         
             
                <li>
                <a class="page-link" href="/help-documentation/ja/gettingstarted/userguides/Improving_Cloud_Performance/">OpenStack の構築 II -- クラウド・パフォーマンスの向上</a>
                </li>
              
         
             
                <li>
                <a class="page-link" href="/help-documentation/ja/gettingstarted/userguides/Optimized_Load_Balancing/">クラウド基礎 -- 最適化されたロード・バランシング</a>
                </li>
              
         
             
                
                  
                  <li class="hidden non-featured">
                    <a class="page-link" href="/help-documentation/ja/gettingstarted/userguides/Cloud_Images_Provided_by_IBM/">クラウド・イメージのユーザーズ・ガイド (コミュニティー版)</a>
                  </li>
              
             
         
             
                
                  
                  <li class="hidden non-featured">
                    <a class="page-link" href="/help-documentation/ja/gettingstarted/userguides/Cloud_Images_Provided_RHOSP/">クラウド・イメージのユーザーズ・ガイド (IBM Bluemix Private Cloud with Red Hat)</a>
                  </li>
              
             
         
             
         
             
         
             
         
             
         
             
                
                  
                  <li class="hidden non-featured">
                    <a class="page-link" href="/help-documentation/ja/gettingstarted/userguides/Image_Release_Notes/">IBM Bluemix Private Cloud イメージのリリース・ノート</a>
                  </li>
              
             
         
        <li><a href="" class="page-link view">View More ( 4 )</a></li>
      </ul>
      
      <ul  class="article__list slide-up-hidden" >
        <h5 class="sub__head">Release Notes</h5>
        
        
          
             
                
                  
                  <li class="hidden non-featured">
                    <a class="page-link" href="/help-documentation/ja/releasenotes/Customer_3.1.1_Point_Release/">カスタマー 3.1.1 ポイントのリリース・ノート</a>
                  </li>
              
             
         
             
                
                  
                  <li class="hidden non-featured">
                    <a class="page-link" href="/help-documentation/ja/releasenotes/Customer_3.0.1_Point_Release/">お客様向け 3.0.1 ポイントのリリース・ノート</a>
                  </li>
              
             
         
             
                
                  
                  <li class="hidden non-featured">
                    <a class="page-link" href="/help-documentation/ja/releasenotes/Customer_4.0.0.0c_Release_Notes/">Release Notes 4.0.0.0c</a>
                  </li>
              
             
         
             
                <li>
                <a class="page-link" href="/help-documentation/ja/releasenotes/Customer_2.1.1_Point_Release/">リリース・ノート 2.1.1</a>
                </li>
              
         
             
                
                  
                  <li class="hidden non-featured">
                    <a class="page-link" href="/help-documentation/ja/releasenotes/Customer_3.1.0_Release_Notes/">リリース・ノート 3.1.0</a>
                  </li>
              
             
         
             
                
                  
                  <li class="hidden non-featured">
                    <a class="page-link" href="/help-documentation/ja/releasenotes/Customer_3.0.0_Release_Notes/">リリース・ノート 3.0.0</a>
                  </li>
              
             
         
             
                <li>
                <a class="page-link" href="/help-documentation/ja/releasenotes/Customer_4.0.0.0r_Release_Notes/">リリース・ノート 4.0.0.0r</a>
                </li>
              
         
             
                
                  
                  <li class="hidden non-featured">
                    <a class="page-link" href="/help-documentation/ja/releasenotes/release_notes_2.1_for_customers/">リリース・ノート 2.1</a>
                  </li>
              
             
         
        <li><a href="" class="page-link view">View More ( 6 )</a></li>
      </ul>
    </li>
    <li>
      <h3 class="title">
        <a  class="page-link"  href="/help-documentation/ja/troubleshooting">Troubleshooting (19)</a>
        <a href=""  class="expand rotate" ><img src="/help-documentation/img/ja/arrow.svg" /></a>
      </h3>
      <ul  class="article__list slide-up-hidden" >
        
        
        
          
          <li>
              <a class="page-link" href="/help-documentation/ja/troubleshooting/ssh-too-long-error/">インスタンスに SSH で接続するのに 4 から 5 秒もかかるのはどうしてですか?</a>
          </li>
          
        
          
          <li>
              <a class="page-link" href="/help-documentation/ja/troubleshooting/ping-instance-error/">インスタンスに SSH/ping できないのはどうしてですか?</a>
          </li>
          
        
          
        
          
          <li>
              <a class="page-link" href="/help-documentation/ja/troubleshooting/nova-microversions-error/">Nova コマンドを実行した場合のエラー「Server doesn't support microversions」</a>
          </li>
          
        
          
          <li>
              <a class="page-link" href="/help-documentation/ja/troubleshooting/libvirt_error/">エラー状況 (libvirt エラー) のインスタンス</a>
          </li>
          
        
          
        
          
            
            
              <li class="hidden non-featured">
                  <a class="page-link" href="/help-documentation/ja/troubleshooting/Bad_Availability_Zone/">Cloud Foundry: 無効な可用性ゾーン・エラー</a>
              </li>
            
          
        
          
          <li>
              <a class="page-link" href="/help-documentation/ja/troubleshooting/How_many_connections_can_HAProxy_handle/">HAProxy で処理できる最大同時接続数</a>
          </li>
          
        
          
            
            
              <li class="hidden non-featured">
                  <a class="page-link" href="/help-documentation/ja/troubleshooting/failed_to_create_router/">ルーターの作成試行が失敗する</a>
              </li>
            
          
        
          
            
            
              <li class="hidden non-featured">
                  <a class="page-link" href="/help-documentation/ja/troubleshooting/failure_prepping_block_device/">エラー「Failure prepping block device」</a>
              </li>
            
          
        
          
            
            
              <li class="hidden non-featured">
                  <a class="page-link" href="/help-documentation/ja/troubleshooting/CLI-authentication-error/">Windows で OpenStack CLI のいずれかを使用すると、認証障害エラーが発生します</a>
              </li>
            
          
        
          
            
            
              <li class="hidden non-featured">
                  <a class="page-link" href="/help-documentation/ja/troubleshooting/Cannot_See_New_vCPUs/">Horizon で新規 vCPU がリストされないのはどうしてですか?</a>
              </li>
            
          
        
          
            
            
              <li class="hidden non-featured">
                  <a class="page-link" href="/help-documentation/ja/troubleshooting/floating-ips-error/">割り当てられている一部の浮動 IP が使用可能でないのはどうしてですか?</a>
              </li>
            
          
        
          
            
            
              <li class="hidden non-featured">
                  <a class="page-link" href="/help-documentation/ja/troubleshooting/no-valid-host-error/">エラー「No valid host was found」</a>
              </li>
            
          
        
          
            
            
              <li class="hidden non-featured">
                  <a class="page-link" href="/help-documentation/ja/troubleshooting/horizon-delete-error/">Horizon ダッシュボードからプロジェクト/テナントを削除できないのはどうしてですか?</a>
              </li>
            
          
        
          
            
            
              <li class="hidden non-featured">
                  <a class="page-link" href="/help-documentation/ja/troubleshooting/delete_security_group/">セキュリティー・グループを削除できないのはどうしてですか?</a>
              </li>
            
          
        
          
          <li>
              <a class="page-link" href="/help-documentation/ja/troubleshooting/Troubleshooting_FAQ/">トラブルシューティングの FAQ</a>
          </li>
          
        
          
            
            
              <li class="hidden non-featured">
                  <a class="page-link" href="/help-documentation/ja/troubleshooting/Unable_to_ping_tenant_network/">テナント・ネットワーク間で ping できないのはどうしてですか?</a>
              </li>
            
          
        
          
            
            
              <li class="hidden non-featured">
                  <a class="page-link" href="/help-documentation/ja/troubleshooting/Why_No_vIP_Failover_With_L2pop/">vIP インスタンスがフェイルオーバーするようにする場合に L2pop を使用できないのはどうしてですか?</a>
              </li>
            
          
        
        <li><a href="" class="page-link view">View More ( 11 )</a></li>
      </ul>
    </li>
    <li>
      <h3 class="title">
        <a  class="page-link"  href="/help-documentation/ja/openstack">Open Stack (15)</a>
        <a href=""  class="expand rotate" ><img src="/help-documentation/img/ja/arrow.svg" /></a>
      </h3>
      <ul  class="article__list slide-up-hidden" >
        <h5 class="sub__head">User Docs</h5>
        
        
        
          
          <li>
              <a class="page-link" href="/help-documentation/ja/openstack/userdocs/import-vhd-image-lvm/">ルート・ディレクトリーに Linux ボリューム管理を使用している VHD イメージのインポート</a>
          </li>
          
        
          
          <li>
              <a class="page-link" href="/help-documentation/ja/openstack/userdocs/launch-instance-from-volume/">ボリュームからのインスタンスの起動方法</a>
          </li>
          
        
          
          <li>
              <a class="page-link" href="/help-documentation/ja/openstack/userdocs/Mitaka_CLI_notes/">OpenStack Mitaka CLI に関する注記</a>
          </li>
          
        
          
            
            
              <li class="non-featured">
                  <a class="page-link" href="/help-documentation/ja/openstack/userdocs/openstack-storage-concepts/">OpenStack ストレージの概念</a>
              </li>
            
          
        
          
            
            
              <li class="non-featured">
                  <a class="page-link" href="/help-documentation/ja/openstack/userdocs/OpenStack_network_concepts/">OpenStack のネットワークの概念</a>
              </li>
            
          
        
          
          <li>
              <a class="page-link" href="/help-documentation/ja/openstack/userdocs/Creating-an-Instance-with-a-Specific-Fixed-IP/">特定の固定 IP を使用したインスタンスの作成</a>
          </li>
          
        
          
            
            
              <li class="non-featured">
                  <a class="page-link" href="/help-documentation/ja/openstack/userdocs/Why-Choose-OpenStack/">OpenStack を選ぶ理由</a>
              </li>
            
          
        
          
          <li>
              <a class="page-link" href="/help-documentation/ja/openstack/userdocs/Ursula_and_OpenStack/">Ursula と OpenStack</a>
          </li>
          
        
          
          <li>
              <a class="page-link" href="/help-documentation/ja/openstack/userdocs/quotas/">割り当て量</a>
          </li>
          
        
          
          <li>
              <a class="page-link" href="/help-documentation/ja/openstack/userdocs/Creating_Instances_With_Static_IP/">静的 IP を使用したインスタンスの作成方法</a>
          </li>
          
        
          
          <li>
              <a class="page-link" href="/help-documentation/ja/openstack/userdocs/How_to_Isolate_Tenants/">テナント (プロジェクト) を分離する方法</a>
          </li>
          
        
          
          <li>
              <a class="page-link" href="/help-documentation/ja/openstack/userdocs/external-reference-material/">外部参照資料</a>
          </li>
          
        
        <li><a href="" class="page-link view">View More ( 3 )</a></li>
      </ul>

      <ul  class="article__list slide-up-hidden" >
        <h5 class="sub__head">API</h5>
        
        
        
          
          <li>
              <a class="page-link" href="/help-documentation/ja/openstack/api/openstack-api-getting-started/">OpenStack API 概要</a>
          </li>
          
        
          
          <li>
              <a class="page-link" href="/help-documentation/ja/openstack/api/floating-ip-address/">OpenStack API を使用した浮動 IP アドレスの作成</a>
          </li>
          
        
          
            
            
              <li class="non-featured">
                  <a class="page-link" href="/help-documentation/ja/openstack/api/OpenStack_Client_Versions/">OpenStack クライアント・バージョンの要件</a>
              </li>
            
          
        
        <li><a href="" class="page-link view">View More ( 1 )</a></li>
      </ul>
    </li>




    <li>
      <h3 class="title">
        <a  class="page-link"  href="/help-documentation/ja/horizon">Horizon [GUI] (10)</a>
        <a href=""  class="expand rotate" ><img src="/help-documentation/img/ja/arrow.svg" /></a>
      </h3>
      <ul  class="article__list slide-up-hidden" >
        
        
        
          
          <li>
              <a class="page-link" href="/help-documentation/ja/horizon/creating-additional-networks-with-horizon/">Horizon パネルを使用した OpenStack での追加ネットワークの作成</a>
          </li>
          
        
          
            
            
              <li class="non-featured">
                  <a class="page-link" href="/help-documentation/ja/horizon/using-horizon/">Horizon の使用</a>
              </li>
            
          
        
          
          <li>
              <a class="page-link" href="/help-documentation/ja/horizon/allocate-floating-ip/">インスタンスへのパブリック (浮動) IP の割り振りおよび関連付け</a>
          </li>
          
        
          
            
            
              <li class="non-featured">
                  <a class="page-link" href="/help-documentation/ja/horizon/create-volume-from-horizon/">Horizon ダッシュボードからのボリュームの作成</a>
              </li>
            
          
        
          
          <li>
              <a class="page-link" href="/help-documentation/ja/horizon/Making_Snapshots_in_Horizon/">スナップショットのための Horizon の使用</a>
          </li>
          
        
          
            
            
              <li class="non-featured">
                  <a class="page-link" href="/help-documentation/ja/horizon/set-reverse-dns/">IBM Bluemix Private Cloud インスタンスに対してリバース DNS (PTR) レコードはどのように設定しますか?</a>
              </li>
            
          
        
          
            
            
              <li class="non-featured">
                  <a class="page-link" href="/help-documentation/ja/horizon/launch-instance-from-horizon/">Horizon ダッシュボードからのインスタンスの起動</a>
              </li>
            
          
        
          
            
            
              <li class="non-featured">
                  <a class="page-link" href="/help-documentation/ja/horizon/launch-instance-from-horizon_newton/">Horizon ダッシュボードからのインスタンスの起動 (OpenStack Newton リリース)</a>
              </li>
            
          
        
          
            
            
              <li class="non-featured">
                  <a class="page-link" href="/help-documentation/ja/horizon/horizon-for-administrators/">管理者のための Horizon</a>
              </li>
            
          
        
          
          <li>
              <a class="page-link" href="/help-documentation/ja/horizon/Horizon_troubleshooting_FAQ/">Horizon トラブルシューティングの FAQ</a>
          </li>
          
        
      </ul>
    </li>

    <li>
      <h3 class="title">
        <a  class="page-link"  href="/help-documentation/ja/nova">Nova [Compute] (13)</a>
        <a href=""  class="expand rotate" ><img src="/help-documentation/img/ja/arrow.svg" /></a>
      </h3>
      <ul  class="article__list slide-up-hidden" >
        
        
        
          
          <li>
              <a class="page-link" href="/help-documentation/ja/nova/CLI-create-public-instance/">コマンド・ラインを使用してインスタンスを作成して公開する方法</a>
          </li>
          
        
          
            
            
              <li class="non-featured">
                  <a class="page-link" href="/help-documentation/ja/nova/windows-user-and-password/">OpenStack で Windows インスタンス上の初期ユーザー名およびパスワードを設定する方法</a>
              </li>
            
          
        
          
          <li>
              <a class="page-link" href="/help-documentation/ja/nova/Nova_boot_speed/">仮想マシンのブート時に水面下で何が行われていますか? また、どうすればブート時間を短縮できますか?</a>
          </li>
          
        
          
          <li>
              <a class="page-link" href="/help-documentation/ja/nova/Restrict_Floating_IP/">浮動 IP を制限するにはどうすればよいでしょうか?</a>
          </li>
          
        
          
            
            
              <li class="non-featured">
                  <a class="page-link" href="/help-documentation/ja/nova/config_drive_for_instances/">インスタンスを作成し、config drive を使用してファイルをそのインスタンスに追加できますか?</a>
              </li>
            
          
        
          
            
            
              <li class="non-featured">
                  <a class="page-link" href="/help-documentation/ja/nova/create-vm-with-volumes/">Nova コマンド・ライン・クライアントを使用したインスタンスの作成方法</a>
              </li>
            
          
        
          
            
            
              <li class="non-featured">
                  <a class="page-link" href="/help-documentation/ja/nova/migrate-instance/">新しいクラウドへのインスタンスのマイグレーション</a>
              </li>
            
          
        
          
            
            
              <li class="non-featured">
                  <a class="page-link" href="/help-documentation/ja/nova/deploy-to-specific-hypervisor/">How to deploy an instance to a specific hypervisor node</a>
              </li>
            
          
        
          
            
            
              <li class="non-featured">
                  <a class="page-link" href="/help-documentation/ja/nova/nova_live_migration/">Instance Live Migration</a>
              </li>
            
          
        
          
            
            
              <li class="non-featured">
                  <a class="page-link" href="/help-documentation/ja/nova/maximum-flavor-spec/">フレーバーで設定できる最大の仕様はどのようになりますか?</a>
              </li>
            
          
        
          
          <li>
              <a class="page-link" href="/help-documentation/ja/nova/define-flavor-vcpu/">フレーバー vCPU トポロジーを定義する方法</a>
          </li>
          
        
          
          <li>
              <a class="page-link" href="/help-documentation/ja/nova/Metadata_service_FAQ/">OpenStack Neutron および Nova でのメタデータ・サービス</a>
          </li>
          
        
          
          <li>
              <a class="page-link" href="/help-documentation/ja/nova/hypervisor-statistics/">ハイパーバイザー統計を取得する方法</a>
          </li>
          
        
      </ul>
    </li>

    <li>
      <h3 class="title">
        <a  class="page-link"  href="/help-documentation/ja/neutron">Neutron [Networking] (22)</a>
        <a href=""  class="expand rotate" ><img src="/help-documentation/img/ja/arrow.svg" /></a>
      </h3>
      <ul  class="article__list slide-up-hidden" >
        
        
        
          
        
          
            
            
              <li class="non-featured">
                  <a class="page-link" href="/help-documentation/ja/neutron/network_ip_availability/">ネットワークの IP の可用性を確認する方法</a>
              </li>
            
          
        
          
            
            
              <li class="non-featured">
                  <a class="page-link" href="/help-documentation/ja/neutron/Multi-tier_Router_Configuration/">IBM Bluemix Private Cloud 内の多層ルーター構成</a>
              </li>
            
          
        
          
            
            
              <li class="non-featured">
                  <a class="page-link" href="/help-documentation/ja/neutron/routing_internal_traffic_between_projects/">プロジェクト間での内部トラフィックのルーティング</a>
              </li>
            
          
        
          
            
            
              <li class="non-featured">
                  <a class="page-link" href="/help-documentation/ja/neutron/configure-dns.for-instances/">インスタンスに対する DNS の構成</a>
              </li>
            
          
        
          
            
            
              <li class="non-featured">
                  <a class="page-link" href="/help-documentation/ja/neutron/Load_Balancing_Methods/">ロード・バランシング方法</a>
              </li>
            
          
        
          
            
            
              <li class="non-featured">
                  <a class="page-link" href="/help-documentation/ja/neutron/set-up-dns-records/">OpenStack インスタンスを指す DNS レコードをセットアップするにはどうすればよいでしょうか?</a>
              </li>
            
          
        
          
            
            
              <li class="non-featured">
                  <a class="page-link" href="/help-documentation/ja/neutron/time-ip-associated-with-instance/">インスタンスに対する浮動 IP の関連付けまたは関連付け解除が行われた時刻を確認するにはどのようにすればよいでしょうか?</a>
              </li>
            
          
        
          
          <li>
              <a class="page-link" href="/help-documentation/ja/neutron/isolatetwoprojectnetworksconnectedtoonesharedrouter/">共有ルーターに接続されたプロジェクト・ネットワークを分離する方法</a>
          </li>
          
        
          
            
            
              <li class="non-featured">
                  <a class="page-link" href="/help-documentation/ja/neutron/creating-virtual-networks/">IBM Bluemix Private Cloud での仮想ネットワークの作成</a>
              </li>
            
          
        
          
          <li>
              <a class="page-link" href="/help-documentation/ja/neutron/add-ip-to-instance/">インスタンスへの特定の固定プライベート IP の追加</a>
          </li>
          
        
          
          <li>
              <a class="page-link" href="/help-documentation/ja/neutron/configure-multi-nics/">独自のクラウド・イメージに対する複数のネットワーク・インターフェースの構成</a>
          </li>
          
        
          
            
            
              <li class="non-featured">
                  <a class="page-link" href="/help-documentation/ja/neutron/configure-ha-ip/">高可用性 IP の構成方法</a>
              </li>
            
          
        
          
            
            
              <li class="non-featured">
                  <a class="page-link" href="/help-documentation/ja/neutron/BYOFIP_support/">IBM Bluemix Private Cloud とお客様サイトの間での BYOFIP 接続の使用</a>
              </li>
            
          
        
          
            
            
              <li class="non-featured">
                  <a class="page-link" href="/help-documentation/ja/neutron/when_create_port_fails/">When creating port failed, how could I do ?</a>
              </li>
            
          
        
          
            
            
              <li class="non-featured">
                  <a class="page-link" href="/help-documentation/ja/neutron/vpn-vlan-directlink/">VPN、VLAN、および Direct Link</a>
              </li>
            
          
        
          
            
            
              <li class="non-featured">
                  <a class="page-link" href="/help-documentation/ja/neutron/How_Can_I_See_My_IPs/">自分の IP はどのように確認できますか?</a>
              </li>
            
          
        
          
            
            
              <li class="non-featured">
                  <a class="page-link" href="/help-documentation/ja/neutron/How_to_update_DNS/">DNS はどのように更新できますか?</a>
              </li>
            
          
        
          
            
            
              <li class="non-featured">
                  <a class="page-link" href="/help-documentation/ja/neutron/Intro_to_LBaaS/">Load Balancer as a Service (LBaaS) の概要</a>
              </li>
            
          
        
          
            
            
              <li class="non-featured">
                  <a class="page-link" href="/help-documentation/ja/neutron/Security_groups_CLI/">CLI を使用したセキュリティー・グループのセットアップ</a>
              </li>
            
          
        
          
          <li>
              <a class="page-link" href="/help-documentation/ja/neutron/Network_Use_Cases_White_Paper/">IBM Blue Box のネットワークのユース・ケース</a>
          </li>
          
        
          
            
            
              <li class="non-featured">
                  <a class="page-link" href="/help-documentation/ja/neutron/Where_Are_These_IPs/">最初の 2 つの IP はどこへいきましたか?</a>
              </li>
            
          
        
      </ul>
    </li>

    <li>
      <h3 class="title">
        <a  class="page-link"  href="/help-documentation/ja/glance">Glance [Images] (6)</a>
        <a href=""  class="expand rotate" ><img src="/help-documentation/img/ja/arrow.svg" /></a>
      </h3>
      <ul  class="article__list slide-up-hidden" >
        
        
        
          
        
          
            
            
              <li class="non-featured">
                  <a class="page-link" href="/help-documentation/ja/glance/disk-capacity-constraints/">ディスク容量の制約</a>
              </li>
            
          
        
          
          <li>
              <a class="page-link" href="/help-documentation/ja/glance/FAQ_Working_with_Windows_Images/">Windows イメージの操作の FAQ</a>
          </li>
          
        
          
            
            
              <li class="non-featured">
                  <a class="page-link" href="/help-documentation/ja/glance/compatible-glance-images/">Glance で使用するためにダウンロードできる正式な OpenStack 互換のイメージのリストはありますか? (CentOS、Ubuntu、など)</a>
              </li>
            
          
        
          
            
            
              <li class="non-featured">
                  <a class="page-link" href="/help-documentation/ja/glance/Image_Properties_on_Power/">Power コンピュート上の Glance イメージの最適設定</a>
              </li>
            
          
        
          
            
            
              <li class="non-featured">
                  <a class="page-link" href="/help-documentation/ja/glance/imagesnapshot/">イメージとスナップショットの違い</a>
              </li>
            
          
        
      </ul>
    </li>

    <li>
      <h3 class="title">
        <a  class="page-link"  href="/help-documentation/ja/cinder">Cinder [Block Storage] (13)</a>
        <a href=""  class="expand rotate" ><img src="/help-documentation/img/ja/arrow.svg" /></a>
      </h3>
      <ul  class="article__list slide-up-hidden" >
        
        
        
          
          <li>
              <a class="page-link" href="/help-documentation/ja/cinder/cinder-volume-stuck/">Cinder ボリュームの停止</a>
          </li>
          
        
          
          <li>
              <a class="page-link" href="/help-documentation/ja/cinder/read-only-cinder-error/">Cinder ボリュームが読み取り専用になるのは何が原因で、どのようにすれば修正できますか</a>
          </li>
          
        
          
            
            
              <li class="non-featured">
                  <a class="page-link" href="/help-documentation/ja/cinder/alternative_method_for_volume_encryption/">ブロック・ストレージ・ボリューム暗号化の代替方式 (Ubuntu ゲスト VM の使用)</a>
              </li>
            
          
        
          
            
            
              <li class="non-featured">
                  <a class="page-link" href="/help-documentation/ja/cinder/Bug_Creating_Encrypted_Volumes/">Cinder による暗号化されたボリュームの作成がサポートされない</a>
              </li>
            
          
        
          
            
            
              <li class="non-featured">
                  <a class="page-link" href="/help-documentation/ja/cinder/create-volume-from-snapshot/">インスタンスのスナップショットからのボリュームの作成はサポートされていますか?</a>
              </li>
            
          
        
          
            
            
              <li class="non-featured">
                  <a class="page-link" href="/help-documentation/ja/cinder/resize_cinder_volume/">Cinder ボリュームはどうすればサイズ変更できますか?</a>
              </li>
            
          
        
          
          <li>
              <a class="page-link" href="/help-documentation/ja/cinder/Managing_block_storage/">ブロック・ストレージの管理</a>
          </li>
          
        
          
            
            
              <li class="non-featured">
                  <a class="page-link" href="/help-documentation/ja/cinder/cli-create-volume/">コマンド・ラインを使用したボリュームの作成</a>
              </li>
            
          
        
          
            
            
              <li class="non-featured">
                  <a class="page-link" href="/help-documentation/ja/cinder/supported_volume_types/">Cloud インスタンスでは、どのような Cinder ボリューム・タイプがサポートされますか? </a>
              </li>
            
          
        
          
            
            
              <li class="non-featured">
                  <a class="page-link" href="/help-documentation/ja/cinder/Ephemeral_to_Cinder/">一時ディスクから Cinder ストレージへの移動方法</a>
              </li>
            
          
        
          
            
            
              <li class="non-featured">
                  <a class="page-link" href="/help-documentation/ja/cinder/volume_clone/">Can I enable volume full clone more than copy-on-write clone?</a>
              </li>
            
          
        
          
            
            
              <li class="non-featured">
                  <a class="page-link" href="/help-documentation/ja/cinder/Force_snapshot_on_attached_volume/">接続されているボリュームでスナップショットを強制する方法</a>
              </li>
            
          
        
          
            
            
              <li class="non-featured">
                  <a class="page-link" href="/help-documentation/ja/cinder/cinder-failed-connection-error/">Cinder クライアントが「ERROR: Unable to establish connection」というメッセージを返して接続できない場合はどうすればよいですか?</a>
              </li>
            
          
        
      </ul>
    </li>

    <li>
      <h3 class="title">
        <a  class="page-link"  href="/help-documentation/ja/keystone">Keystone [Identity] (8)</a>
        <a href=""  class="expand rotate" ><img src="/help-documentation/img/ja/arrow.svg" /></a>
      </h3>
      <ul  class="article__list slide-up-hidden" >
        
        
        
          
            
            
              <li class="non-featured">
                  <a class="page-link" href="/help-documentation/ja/keystone/k2k-federation/">IBM Bluemix Private Cloud での Keystone to Keystone (K2K) フェデレーション</a>
              </li>
            
          
        
          
            
            
              <li class="non-featured">
                  <a class="page-link" href="/help-documentation/ja/keystone/Managing_Users_and_Projects/">ユーザーおよびプロジェクトの管理</a>
              </li>
            
          
        
          
            
            
              <li class="non-featured">
                  <a class="page-link" href="/help-documentation/ja/keystone/RBAC_Definitions/">役割ベースのアクセス制御</a>
              </li>
            
          
        
          
            
            
              <li class="non-featured">
                  <a class="page-link" href="/help-documentation/ja/keystone/saml-federation/">IBM Bluemix Private Cloud での Keystone SAML フェデレーション</a>
              </li>
            
          
        
          
            
            
              <li class="non-featured">
                  <a class="page-link" href="/help-documentation/ja/keystone/oidc-federation/">IBM Bluemix Private Cloud での OpenID Connect フェデレーション</a>
              </li>
            
          
        
          
          <li>
              <a class="page-link" href="/help-documentation/ja/keystone/Getting_Started_with_K2K_Identity/">Keystone Federated Identity 概要</a>
          </li>
          
        
          
            
            
              <li class="non-featured">
                  <a class="page-link" href="/help-documentation/ja/keystone/custom-domains-keystone/">Keystone V3 内のカスタム・ドメイン</a>
              </li>
            
          
        
          
            
            
              <li class="non-featured">
                  <a class="page-link" href="/help-documentation/ja/keystone/tenants-security-groups-keystone/">プロジェクトおよびセキュリティー・グループ</a>
              </li>
            
          
        
      </ul>
    </li>

    <li>
      <h3 class="title">
        <a  class="page-link"  href="/help-documentation/ja/heat">Heat [Orchestration] (7)</a>
        <a href=""  class="expand rotate" ><img src="/help-documentation/img/ja/arrow.svg" /></a>
      </h3>
      <ul  class="article__list slide-up-hidden" >
        
        
        
          
        
          
          <li>
              <a class="page-link" href="/help-documentation/ja/heat/Getting_Started_With_Heat/">Heat テンプレート入門</a>
          </li>
          
        
          
          <li>
              <a class="page-link" href="/help-documentation/ja/heat/Deploying_apps_with_UCD/">IBM UrbanCode Deploy および IBM Bluemix Private Cloud でのアプリケーションのデプロイ</a>
          </li>
          
        
          
            
            
              <li class="non-featured">
                  <a class="page-link" href="/help-documentation/ja/heat/autoscaling-with-heat/">自動スケーリングのための Heat の使用</a>
              </li>
            
          
        
          
            
            
              <li class="non-featured">
                  <a class="page-link" href="/help-documentation/ja/heat/using_heat_for_load_balancer/">サーバーにロード・バランサーをプロビジョニングするために Heat を使用</a>
              </li>
            
          
        
          
            
            
              <li class="non-featured">
                  <a class="page-link" href="/help-documentation/ja/heat/using-ucd-ucdp/">IBM Bluemix Private Cloud での IBM Urban Code Deploy の使用</a>
              </li>
            
          
        
          
            
            
              <li class="non-featured">
                  <a class="page-link" href="/help-documentation/ja/heat/using_heat_for_deployment/">自己署名証明書による Heat の使用</a>
              </li>
            
          
        
      </ul>
    </li>


    <li>
      <h3 class="title">
        <a  class="page-link"  href="/help-documentation/ja/ceilometer">Ceilometer [Telemetry] (1)</a>
        <a href=""  class="expand rotate" ><img src="/help-documentation/img/ja/arrow.svg" /></a>
      </h3>
      <ul  class="article__list slide-up-hidden" >
        
        
        
          
            
            
              <li class="non-featured">
                  <a class="page-link" href="/help-documentation/ja/ceilometer/compatible-glance-images/">インスタンスのスナップショットからのボリュームの作成はサポートされていますか?</a>
              </li>
            
          
        
      </ul>
    </li>

  </ul>
</div>


<article>

  <div class="page-container">

    <div class="main-content">
      <header class="post-header">

        <h1 class="post-title">
        

        

        インスタンスでの OpenVPN サーバーのセットアップ

        
        </h1>




        
        <div class="post-data">
          <img src='/help-documentation/img/ja/avatar.png' />
          <ul class="author--info">
            <li>
              <span class="author">by Jason Kennedy </span>
              <span class="dot">&#9679;</span>
              <span class="date"> January 7th, 2016</span>
            </li>
            <li>
              <span class="job-title"></span>
            </li>
            <li class="tags">
              
                <h4>Tags:</h4>
                  <ul class="tag--list">
                  
                    <li class="tag"><p>はじめに</p></li>
                  
                    <li class="tag"><p>openVPN のセットアップ</p></li>
                  
                  </ul>
              
            </li>
          </ul>
        </div>
        
      </header>

      <div class="post-content">
        <p>社内の Bluemix Private Cloud インスタンスに接続する必要があるけれども、使用可能な浮動 IP アドレスがない、あるいはそれらの仮想マシンをインターネット上に配置したくない場合、1 つの手段として、要塞ホストを設定し、そこで OpenVPN を実行するという方法があります。このすることで、このホストを通過して社内ネットワークに接続できます。この記事では、接続用の OpenVPN サーバーとクライアントをインストールしてセットアップする方法を説明します。前提条件として、浮動 IP が割り振られている仮想マシンが既に実行中であるものとします。ここでは ufw の設定や Linux の強化については説明しません。OpenStack でホストされたインスタンス上で、OpenVPN を稼働させる方法について説明します。この例では Ubuntu 14.04 を使用します。</p>

<p>サーバー・サイドのセットアップでは、以下の手順を実行します。</p>

<h2 id="ステップ-1---openvpn-の構成">ステップ 1 - OpenVPN の構成</h2>

<p>パッケージをインストールする前に、まず Ubuntu のリポジトリー・リストを更新します。</p>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash">apt-get update</code></pre></figure>

<p>次に、OpenVPN および Easy-RSA をインストールできます。</p>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash">apt-get install openvpn easy-rsa</code></pre></figure>

<p>サンプルの VPN サーバー構成ファイルを <code class="highlighter-rouge">/etc/openvpn</code> に抽出して、セットアップに取り込めるようにする必要があります。この抽出は、次の 1 つのコマンドで実行できます。</p>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash">gunzip -c /usr/share/doc/openvpn/examples/sample-config-files/server.conf.gz &gt; /etc/openvpn/server.conf</code></pre></figure>

<p>抽出したら、<code class="highlighter-rouge">server.conf</code> をテキスト・エディターで開きます。このチュートリアルでは <strong>Vim</strong> を使用しますが、どのようなエディターを使用してもかまいません。</p>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash">vim /etc/openvpn/server.conf</code></pre></figure>

<p>このファイルでいくつかの変更を行います。以下のようなセクションがあります。</p>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash"><span class="c"># Diffie hellman parameters.
</span>
<span class="c"># Generate your own with:
</span>
<span class="c">#   openssl dhparam -out dh1024.pem 1024
</span>
<span class="c"># Substitute 2048 for 1024 if you are using
</span>
<span class="c"># 2048 bit keys.
</span>
dh dh1024.pem</code></pre></figure>

<p><code class="highlighter-rouge">dh1024.pem</code> を <code class="highlighter-rouge">dh2048.pem</code> に編集します。</p>

<p>この変更により、サーバー鍵およびクライアント鍵を生成するときに使用される RSA 鍵の長さが倍になります。</p>

<p>引き続き <code class="highlighter-rouge">server.conf</code> ファイル内で、次のセクションを探します。</p>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash"><span class="c"># If enabled, this directive will configure
</span>
<span class="c"># all clients to redirect their default
</span>
<span class="c"># network gateway through the VPN, causing
</span>
<span class="c"># all IP traffic such as web browsing and
</span>
<span class="c"># and DNS lookups to go through the VPN
</span>
<span class="c"># (The OpenVPN server machine may need to NAT
</span>
<span class="c"># or bridge the TUN/TAP interface to the internet
</span>
<span class="c"># in order for this to work properly).
</span>
;push <span class="s2">"redirect-gateway def1 bypass-dhcp"</span></code></pre></figure>

<p><code class="highlighter-rouge">push "redirect-gateway def1 bypass-dhcp"</code> のコメントを外して、VPN サーバーがクライアントの Web トラフィックを宛先に渡すようにします。操作を行うと、この行は次のようになります。</p>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash">push <span class="s2">"redirect-gateway def1 bypass-dhcp"</span></code></pre></figure>

<p>次に、ファイルの以下の領域を編集します。</p>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash"><span class="c"># Certain Windows-specific network settings
</span>
<span class="c"># can be pushed to clients, such as DNS
</span>
<span class="c"># or WINS server addresses.  CAVEAT:
</span>
<span class="c"># http://openvpn.net/faq.html#dhcpcaveats
</span>
<span class="c"># The addresses below refer to the public
</span>
<span class="c"># DNS servers provided by opendns.com.
</span>
;push <span class="s2">"dhcp-option DNS 208.67.222.222"</span>
;push <span class="s2">"dhcp-option DNS 208.67.220.220"</span></code></pre></figure>

<p><code class="highlighter-rouge">push "dhcp-option DNS 208.67.222.222"</code> および <code class="highlighter-rouge">push "dhcp-option DNS 208.67.220.220"</code> のコメントを外します。操作を実行すると、エントリーは以下のようになります。</p>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash">push <span class="s2">"dhcp-option DNS 208.67.222.222"</span>
push <span class="s2">"dhcp-option DNS 208.67.220.220"</span></code></pre></figure>

<p>このエントリーは、可能な場合に DNS 解決のために <strong>OpenDNS</strong> を接続済みクライアントにプッシュするようにサーバーに指示します。push を使用すると、DNS 要求が VPN 接続の外側に漏れるのを防ぐ効果があります。ただし、必要な DNS リゾルバーをクライアント・デバイスに指定することも重要です。<strong>OpenDNS</strong> は <strong>OpenVPN</strong> で使用されるデフォルトですが、任意の DNS サービスを使用できます。</p>

<p><code class="highlighter-rouge">server.conf</code> ファイル内で変更する最後の領域は以下のとおりです。</p>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash"><span class="c"># You can uncomment this out on
</span>
<span class="c"># non-Windows systems.
</span>
;user nobody
;group nogroup</code></pre></figure>

<p><code class="highlighter-rouge">user nobody</code> および <code class="highlighter-rouge">group nogroup</code> のコメントを外します。操作を行うと、エントリーは以下のようになります。</p>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash">user nobody
group nogroup</code></pre></figure>

<p>デフォルトでは、<strong>OpenVPN</strong> は root ユーザーとして実行されるため、システムへの完全な root アクセス権限を持ちます。代わりに、<strong>OpenVPN</strong> を <code class="highlighter-rouge">user nobody</code> および <code class="highlighter-rouge">group nogroup</code> に制限します。これは、デフォルトのログイン機能を持たない非特権ユーザーで、大抵の場合、Web 側のサーバーなどの信頼できないアプリケーションの実行用に予約されます。</p>

<p>変更内容を保存し、<strong>Vim</strong> を終了します。</p>

<h3 id="パケット転送">パケット転送</h3>

<p>クライアント・デバイスからインターネットにトラフィックを転送するようにサーバーのカーネルに指示する <code class="highlighter-rouge">sysctl</code> 設定が必要です。これを行わないと、トラフィックはサーバーで停止します。以下のコマンドを入力して、ランタイム中のパケット転送を有効にします。</p>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash"><span class="nb">echo </span>1 &gt; /proc/sys/net/ipv4/ip_forward</code></pre></figure>

<p>次に、サーバーがリブート後もトラフィックを転送するように、この転送を永続的にする必要があります。</p>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash">vim /etc/sysctl.conf</code></pre></figure>

<p><code class="highlighter-rouge">sysctl</code> ファイルの先頭付近に、以下の記述があります。</p>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash"><span class="c"># Uncomment the next line to enable packet forwarding for IPv4
</span>
<span class="c">#net.ipv4.ip_forward=1</span></code></pre></figure>

<p>net.ipv4.ip_forward のコメントを外します。操作を行うと、この行は次のようになります。</p>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash"><span class="c"># Uncomment the next line to enable packet forwarding for IPv4
</span>
net.ipv4.ip_forward<span class="o">=</span>1</code></pre></figure>

<p>変更内容を保存し、<strong>Vim</strong> を終了します。</p>

<h3 id="uncomplicated-firewall-ufw">Uncomplicated Firewall (ufw)</h3>

<p><code class="highlighter-rouge">ufw</code> は iptables のフロントエンドです。<code class="highlighter-rouge">ufw</code> の設定は難しくありません。これはデフォルトで Ubuntu 14.04 に組み込まれているため、必要な操作としては、いくつかのルールと構成の編集を行い、ファイアウォールをオンに切り替えるだけです。<code class="highlighter-rouge">ufw</code> の使用については、『<strong>Ubuntu および Debian のクラウド・サーバー上での UFW を使用したファイアウォールのセットアップ方法</strong>』を参照してください。</p>

<p>まず、SSH を許可するように <code class="highlighter-rouge">ufw</code> を設定します。コマンド・プロンプトで、次のように入力します。</p>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash">ufw allow ssh</code></pre></figure>

<p>このチュートリアルでは UDP 上で <strong>OpenVPN</strong> を使用するため、ufw ではポート 1194 上の UDP トラフィックを許可する必要もあります。</p>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash">ufw allow 1194/udp</code></pre></figure>

<p><code class="highlighter-rouge">ufw</code> 転送ポリシーも設定する必要があります。これは ufw のプライマリー構成ファイルで行います。</p>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash">vim /etc/default/ufw</code></pre></figure>

<p><code class="highlighter-rouge">DEFAULT_FORWARD_POLICY="DROP"</code> を探します。このエントリーは <code class="highlighter-rouge">DROP</code> から <code class="highlighter-rouge">ACCEPT</code> に変更する必要があります。操作を実行すると、エントリーは以下のようになります。</p>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash"><span class="nv">DEFAULT_FORWARD_POLICY</span><span class="o">=</span><span class="s2">"ACCEPT"</span></code></pre></figure>

<p>次に、接続されたクライアントのネットワーク・アドレス変換と IP マスカレードのための <code class="highlighter-rouge">ufw</code> ルールを追加します。</p>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash">vim /etc/ufw/before.rules</code></pre></figure>

<p><code class="highlighter-rouge">before.rules</code> ファイルの先頭を以下の例のようにします。<code class="highlighter-rouge">OPENVPN RULES</code> についての赤色の領域を追加する必要があります。</p>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash"><span class="c">#
</span>
<span class="c"># rules.before
</span>
<span class="c">#
</span>
<span class="c"># Rules that should be run before the ufw command line added rules. カスタム
</span>
<span class="c"># rules should be added to one of these chains:
</span>
<span class="c">#   ufw-before-input
</span>
<span class="c">#   ufw-before-output
</span>
<span class="c">#   ufw-before-forward
</span>
<span class="c">#
</span>

<span class="c"># START OPENVPN RULES
</span>
<span class="c"># NAT table rules
</span>
<span class="k">*</span>nat
:POSTROUTING ACCEPT <span class="o">[</span>0:0]
<span class="c"># Allow traffic from OpenVPN client to eth0
</span>
-A POSTROUTING -s 10.8.0.0/8 -o eth0 -j MASQUERADE
COMMIT
<span class="c"># END OPENVPN RULES
</span>

<span class="c"># Don't delete these required lines, otherwise there will be errors
</span>
<span class="k">*</span>filter</code></pre></figure>

<p><code class="highlighter-rouge">ufw</code> への変更を行ったため、これを有効にできます。コマンド・プロンプトに次のように入力します。</p>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash">ufw <span class="nb">enable</span></code></pre></figure>

<p><code class="highlighter-rouge">ufw</code> を有効にすると、次のプロンプトが返されます。</p>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash">Command may disrupt existing ssh connections. Proceed with operation <span class="o">(</span>y|n<span class="o">)</span>?</code></pre></figure>

<p><code class="highlighter-rouge">y</code> で回答します。結果として以下の出力が表示されます。</p>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash">Firewall is active and enabled on system startup</code></pre></figure>

<p>ufw のプライマリー・ファイアウォール・ルールを確認するには、以下のように入力します。</p>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash">ufw status</code></pre></figure>

<p>status コマンドによって以下の結果が返されます。</p>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash">Status: active

To                         Action      From
--                         ------      ----
22                         ALLOW       Anywhere
1194/udp                   ALLOW       Anywhere
22 <span class="o">(</span>v6<span class="o">)</span>                    ALLOW       Anywhere <span class="o">(</span>v6<span class="o">)</span>
1194/udp <span class="o">(</span>v6<span class="o">)</span>              ALLOW       Anywhere <span class="o">(</span>v6<span class="o">)</span></code></pre></figure>

<h2 id="ステップ-2---認証局およびサーバーサイドの証明書と鍵の作成">ステップ 2 - 認証局およびサーバー・サイドの証明書と鍵の作成</h2>

<p><strong>OpenVPN</strong> ではトラフィックを暗号化するために証明書を使用します。</p>

<h3 id="認証局の構成および構築">認証局の構成および構築</h3>

<p>次に、独自の認証局 (CA) をセットアップし、<strong>OpenVPN</strong> サーバー用の証明書および鍵を生成します。<strong>OpenVPN</strong> は証明書に基づく双方向認証をサポートします。つまり、相互の信頼を確立するには、クライアントはサーバー証明書を認証し、サーバーはクライアント証明書を認証する必要があります。これを行うには、以前にコピーした Easy RSA のスクリプトを使用します。</p>

<p>まず、Easy-RSA 生成スクリプトをコピーします。</p>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash">cp -r /usr/share/easy-rsa/ /etc/openvpn</code></pre></figure>

<p>次に、鍵保管ディレクトリーを作成します。</p>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash">mkdir /etc/openvpn/easy-rsa/keys</code></pre></figure>

<p>Easy-RSA には、個人、企業、または選択したあらゆるエンティティーが排他的に使用する証明書を作成するための、編集可能な 1 つの変数ファイルがあります。この情報は証明書と鍵にコピーされ、後で鍵を特定するのに役立ちます。</p>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash">vim /etc/openvpn/easy-rsa/vars</code></pre></figure>

<p>以下の変数を、好みに応じて変更する必要があります。</p>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash"><span class="nb">export </span><span class="nv">KEY_COUNTRY</span><span class="o">=</span><span class="s2">"US"</span>
<span class="nb">export </span><span class="nv">KEY_PROVINCE</span><span class="o">=</span><span class="s2">"TX"</span>
<span class="nb">export </span><span class="nv">KEY_CITY</span><span class="o">=</span><span class="s2">"Dallas"</span>
<span class="nb">export </span><span class="nv">KEY_ORG</span><span class="o">=</span><span class="s2">"My Company Name"</span>
<span class="nb">export </span><span class="nv">KEY_EMAIL</span><span class="o">=</span><span class="s2">"sammy@example.com"</span>
<span class="nb">export </span><span class="nv">KEY_OU</span><span class="o">=</span><span class="s2">"MYOrganizationalUnit"</span></code></pre></figure>

<p>同じ vars ファイルで、以下に示す 1 行についても編集します。簡潔にするために、鍵の名前として server を使用します。別の名前を使用する場合は、<code class="highlighter-rouge">server.key</code> および <code class="highlighter-rouge">server.crt</code> を参照する <strong>OpenVPN</strong> 構成ファイルも更新する必要があります。</p>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash"><span class="nb">export </span><span class="nv">KEY_NAME</span><span class="o">=</span><span class="s2">"server"</span></code></pre></figure>

<p>Diffie-Hellman パラメーターを生成する必要があります。これには数分かかることがあります。</p>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash">openssl dhparam -out /etc/openvpn/dh2048.pem 2048</code></pre></figure>

<p>ここでディレクトリーを変更し、ステップ 2 の前半で Easy-RSA のスクリプトを移動した先で直接作業を行います。</p>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash"><span class="nb">cd</span> /etc/openvpn/easy-rsa</code></pre></figure>

<p>PKI (公開鍵インフラストラクチャー) を初期化します。<code class="highlighter-rouge">./varscommand</code> の前にあるドット (.) およびスペースに注意してください。これは現行作業ディレクトリー (ソース) を示します。</p>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash">. ./vars</code></pre></figure>

<p>上記コマンドからの出力を以下に示します。まだ keysdirectory に何も生成していないので、警告を気にする必要はありません。</p>

<p>注: <code class="highlighter-rouge">./clean-all</code> を実行した場合、<code class="highlighter-rouge">/etc/openvpn/easy-rsa/keys</code> で <code class="highlighter-rouge">rm -rf</code> が実行されます。ここで、新しい鍵のためのスペースを確保するために、作業ディレクトリー内の古い鍵または鍵のサンプルをクリアします。</p>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash">./clean-all</code></pre></figure>

<p>以下の最後のコマンドは、対話式 <strong>OpenSSL</strong> コマンドを呼び出して認証局 (CA) を構築します。出力では、前に Easy-RSA の変数ファイルに入力した識別名変数 (国の名前、組織など) の確認を求めるプロンプトが出されます。</p>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash">./build-ca</code></pre></figure>

<p>各プロンプトで先へ進むには ENTER を押します。何らかの変更が必要な場合は、プロンプト内で行うことができます。</p>

<h3 id="サーバーの証明書および鍵の生成">サーバーの証明書および鍵の生成</h3>

<p>引き続き <code class="highlighter-rouge">/etc/openvpn/easy-rsa</code> で作業を行い、サーバーの鍵を作成するためのコマンドを入力します。赤色で表示された server は、ステップ 2 の前半で Easy-RSA の vars ファイル内で設定した <code class="highlighter-rouge">export KEY_NAME</code> 変数です。</p>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash">./build-key-server server</code></pre></figure>

<p><code class="highlighter-rouge">./build-ca</code> を実行したときと類似した出力が生成されます。ここでも ENTER を押して、識別名の各行を確認できます。ただし、今回は 2 つの追加のプロンプトがあります。</p>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash">Please enter the following <span class="s1">'extra'</span> attributes
to be sent with your certificate request
A challenge password <span class="o">[]</span>:

オプションの会社名 <span class="o">[]</span>:</code></pre></figure>

<p>両方ともブランクのままにし、ENTER を押して各プロンプトで先へ進みます。</p>

<p>最後に追加される 2 つの照会では、肯定応答 (<code class="highlighter-rouge">y</code>) が必要です。</p>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash">Sign the certificate? <span class="o">[</span>y/n]
1 out of 1 certificate requests certified, commit? <span class="o">[</span>y/n]</code></pre></figure>

<p>上記の最後のプロンプトは、以下のように終了します。</p>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash">Write out database with 1 new entries
Data Base Updated</code></pre></figure>

<h3 id="サーバー証明書および鍵の移動">サーバー証明書および鍵の移動</h3>

<p>OpenVPN では、サーバーの CA、証明書、および鍵が <code class="highlighter-rouge">/etc/openvpn</code> にある必要があります。ここではそれらを適切な場所にコピーします。</p>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash">cp /etc/openvpn/easy-rsa/keys/<span class="o">{</span>server.crt,server.key,ca.crt<span class="o">}</span> /etc/openvpn</code></pre></figure>

<p>以下のコマンドを使用して、コピー操作が正常に実行されたことを確認できます。</p>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash">ls /etc/openvpn</code></pre></figure>

<p>サーバー用の証明書および鍵ファイルが表示されるはずです。</p>

<p>この時点で、<strong>OpenVPN</strong> サーバーを開始する準備ができました。開始して状況を確認します。</p>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash">service openvpn start
service openvpn status</code></pre></figure>

<p>status コマンドは以下の結果を返します。</p>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash">VPN <span class="s1">'server'</span> is running</code></pre></figure>

<p>おめでとうございます。OpenVPN サーバーは動作中です。</p>

<p>VPN が動作していないと状況メッセージが示す場合は、<code class="highlighter-rouge">/var/log/syslog</code> ファイルを確認して以下のようなエラーがないか調べてください。</p>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash">Options error: --key fails with <span class="s1">'server.key'</span>: No such file or directory</code></pre></figure>

<p>このエラーは、<code class="highlighter-rouge">server.key</code> が <code class="highlighter-rouge">/etc/openvpn</code> に正しくコピーされていないことを示しています。ファイルを再びコピーして、再試行してください。</p>

<h2 id="ステップ-3---クライアント用の証明書および鍵の生成">ステップ 3 - クライアント用の証明書および鍵の生成</h2>

<p>ここまでは、<strong>OpenVPN</strong> サーバーをインストールして構成し、認証局を作成し、サーバー独自の証明書および鍵を作成しました。このステップでは、サーバーの CA を使用して、VPN に接続する各クライアント・デバイスの証明書および鍵を生成します。これらのファイルは、後でラップトップまたはスマートフォンなどのクライアント・デバイスにインストールされます。</p>

<h3 id="鍵および証明書の作成">鍵および証明書の作成</h3>

<p>VPN に接続する各クライアントが独自の固有の証明書および鍵を持っていることが理想的です。このセットアップは、1 つの汎用的な証明書および鍵を生成してすべてのクライアント・デバイスで使用するよりも好ましい方法です。</p>

<p><strong>注:</strong> デフォルトでは、同じ証明書と鍵を使用して複数のクライアントがサーバーに同時接続することは <strong>OpenVPN</strong> では許可されません (<code class="highlighter-rouge">/etc/openvpn/server.conf</code> の <code class="highlighter-rouge">duplicate-cn</code> を参照してください)。</p>

<p>VPN に接続する予定のデバイスごとに別々の認証資格情報を作成するには、デバイスごとに以下のステップを実行する必要があります。ただし、以下の <code class="highlighter-rouge">client1</code> という名前は <code class="highlighter-rouge">client2</code> や <code class="highlighter-rouge">iphone2</code> などの別の名前に変更してください。デバイスごとに別々の資格情報を使用すると、必要に応じて、後からデバイスを個別にサーバーで非アクティブ化できます。このチュートリアルの残りの例では、クライアント・デバイスの名前の例として <code class="highlighter-rouge">client1</code> を使用します。</p>

<p>サーバーの鍵で行ったように、<code class="highlighter-rouge">client1</code> の例に対して 1 つの鍵を作成します。引き続き <code class="highlighter-rouge">/etc/openvpn/easy-rsa</code> で作業する必要があります。</p>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash">./build-key client1</code></pre></figure>

<p>再び識別名変数の変更または確認を求められます。これらの 2 つのプロンプトはブランクのままにしておく必要があります。ENTER を押してデフォルトを受け入れます。</p>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash">Please enter the following <span class="s1">'extra'</span> attributes
to be sent with your certificate request
A challenge password <span class="o">[]</span>:

オプションの会社名 <span class="o">[]</span>:</code></pre></figure>

<p>前回と同じように、作成プロセスの最後の 2 つの確認には、(<code class="highlighter-rouge">y</code>) の応答が必要です。</p>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash">Sign the certificate? <span class="o">[</span>y/n]
1 out of 1 certificate requests certified, commit? <span class="o">[</span>y/n]</code></pre></figure>

<p>鍵が正常に作成された場合、再び以下のように出力されます。</p>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash">Write out database with 1 new entries
Data Base Updated</code></pre></figure>

<p>サンプルのクライアント構成ファイルを、やはり Easy-RSA 鍵ディレクトリーにコピーする必要があります。ここでは、編集のためにクライアント・デバイスにダウンロードされるテンプレートとしてこのファイルを使用します。コピー・プロセスで、サンプル・ファイルの名前を <code class="highlighter-rouge">client.conf</code> から <code class="highlighter-rouge">client.ovpn</code> に変更します。これは、<code class="highlighter-rouge">.ovpn</code> のファイル拡張子がクライアントで使用されると予想されるためです。</p>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash">cp /usr/share/doc/openvpn/examples/sample-config-files/client.conf /etc/openvpn/easy-rsa/keys/client.ovpn</code></pre></figure>

<p>クライアントごとにこのセクションを繰り返すことができます。その際は、<code class="highlighter-rouge">client1</code> を適切なクライアント名に置き換えます。</p>

<h3 id="クライアントデバイスへの証明書および鍵の転送">クライアント・デバイスへの証明書および鍵の転送</h3>

<p>上記のステップでは、クライアント証明書および鍵を作成し、それらを <strong>OpenVPN</strong> サーバーの <code class="highlighter-rouge">/etc/openvpn/easy-rsa/keys</code> ディレクトリーに格納しました。</p>

<p>各クライアントについて、クライアント証明書、鍵、およびプロファイル・テンプレート・ファイルを、ローカル・コンピューターまたは別のクライアント・デバイス上のフォルダーに転送する必要があります。</p>

<p>この例では、<code class="highlighter-rouge">client1</code> デバイスは、サーバーの以下の場所に配置されている証明書および鍵を必要としています。</p>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash">/etc/openvpn/easy-rsa/keys/client1.crt
/etc/openvpn/easy-rsa/keys/client1.key</code></pre></figure>

<p><code class="highlighter-rouge">ca.crt</code> ファイルおよび <code class="highlighter-rouge">client.ovpn</code> ファイルはすべてのクライアントについて同じです。これらの 2 つのファイルもダウンロードします。<code class="highlighter-rouge">ca.crt</code> ファイルは他のファイルとは異なるディレクトリーにあることに注意してください。</p>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash">/etc/openvpn/easy-rsa/keys/client.ovpn
/etc/openvpn/ca.crt</code></pre></figure>

<p>この転送の実行に使用される正確なアプリケーションは、ユーザーの選択およびデバイスのオペレーティング・システムによって異なりますが、そのアプリケーションではバックエンドで SFTP (SSH ファイル転送プロトコル) または SCP (Secure Copy) を使用する必要があります。これにより、クライアントの VPN 認証ファイルは暗号化された接続を介して転送されます。</p>

<p>以下に、<code class="highlighter-rouge">client1</code> の例を使用した SCP コマンドの例を示します。これにより、ファイル <code class="highlighter-rouge">client1.key</code> がローカル・コンピューターの Downloads ディレクトリーに配置されます。</p>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash">scp root@your-server-ip:/etc/openvpn/easy-rsa/keys/client1.key Downloads/</code></pre></figure>

<p>以下に、ファイルをサーバーからローカル・コンピューターに安全に転送するためのいくつかのツールとチュートリアルを示します。</p>

<p>WinSCP
How To Use SFTP to Securely Transfer Files with a Remote Server
How To Use Filezilla to Transfer and Manage Files Securely on your VPS</p>

<p>このセクションの最後に、以下の 4 つのファイルがクライアント・デバイスにあることを確認してください。</p>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash">client1.crt
client1.key
client.ovpn
ca.crt</code></pre></figure>

<h2 id="ステップ-4---クライアントデバイス用の一元化された-openvpn-プロファイルの作成">ステップ 4 - クライアント・デバイス用の一元化された OpenVPN プロファイルの作成</h2>

<p>クライアント・ファイルの管理方法にはいくつかありますが、最も簡単な方法は一元化プロファイルを使用することです。これは、サーバーの認証局とクライアントの証明書および鍵を含めるように client.ovpn テンプレート・ファイルを変更することで作成されます。マージされると、単一の client.ovpn プロファイルのみをクライアントの OpenVPN アプリケーションにインポートするだけでよくなります。</p>

<p>client1 デバイス用の単一プロファイルの作成は、すべてのクライアント・ファイルをダウンロードしたローカル・コンピューター上で行います。このローカル・コンピューター自体は、目的のクライアントである場合もあれば、単に認証ファイルをマージするための一時的な作業領域である場合もあります。元の client.ovpn テンプレート・ファイルは、複製して名前変更する必要があります。これを行う方法は、ローカル・コンピューターのオペレーティング・システムによって異なります。</p>

<p>注: 複製された client.ovpn の名前はクライアント・デバイスに関連している必要はありません。クライアント・サイドの OpenVPN アプリケーションは、このファイル名を VPN 接続そのものの識別子として使用します。よって、オペレーティング・システム内で VPN のネームタグとして使用したい任意の名前を使用して client.ovpn を複製する必要があります。例えば、work.ovpn は work として識別され、school.ovpn は school として識別されます。</p>

<p>このチュートリアルでは、VPN 接続の名前を Test1 にするため、今後参照されるファイル名は Test1.ovpn となります。名前を付けた後、Test1.ovpn をテキスト・エディターで開く必要があります。エディターはお好みのものを使用できます。</p>

<p>最初に着目すべき領域は、Droplet の IP アドレスです。ファイルの先頭付近の my-server-1 を変更して、VPN の IP を反映させます。</p>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash"><span class="c"># The hostname/IP and port of the server.
</span>
<span class="c"># You can have multiple remote entries
</span>
<span class="c"># to load balance between the servers.
</span>
remote my-server-1 1194</code></pre></figure>

<p>次に、以下に示す領域を見つけ、ステップ 1 の <code class="highlighter-rouge">server.conf</code> で行ったように、<code class="highlighter-rouge">user nobody</code> および <code class="highlighter-rouge">group nogroup</code> のコメントを外します。注: このステップは Windows には該当しないため、スキップできます。操作を行うと、エントリーは以下のようになります。</p>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash"><span class="c"># Downgrade privileges after initialization (non-Windows only)
</span>
user nobody
group nogroup</code></pre></figure>

<p>以下に示す領域では、3 つの行をコメントにして取り除く必要があり、そうすることで、証明書および鍵を <code class="highlighter-rouge">Test1.ovpn</code> ファイルに直接含めることができます。操作を行うと、以下のようになります。</p>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash"><span class="c"># SSL/TLS parms.
</span>
<span class="c"># . . .
</span>
<span class="c">#ca ca.crt
</span>
<span class="c">#cert client.crt
</span>
<span class="c">#key client.key</span></code></pre></figure>

<p>個々のファイルを 1 つの統合プロファイルにマージするために、<code class="highlighter-rouge">ca.crt</code> ファイル、<code class="highlighter-rouge">client1.crt</code> ファイル、および <code class="highlighter-rouge">client1.key</code> ファイルの内容が、基本的な XML 形式の構文を使用して <code class="highlighter-rouge">.ovpn</code> プロファイルに直接貼り付けられます。ファイルの末尾にある XML は、以下の形式になります。</p>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash">&lt;ca&gt;
<span class="o">(</span>insert ca.crt here<span class="o">)</span>
&lt;/ca&gt;
&lt;cert&gt;
<span class="o">(</span>insert client1.crt here<span class="o">)</span>
&lt;/cert&gt;
&lt;key&gt;
<span class="o">(</span>insert client1.key here<span class="o">)</span>
&lt;/key&gt;</code></pre></figure>

<p>完了すると、ファイルの末尾は以下の簡略化された例のようになります。</p>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash">&lt;ca&gt;
-----BEGIN CERTIFICATE-----
. . .
-----END CERTIFICATE-----
&lt;/ca&gt;

&lt;cert&gt;
Certificate:
. . .
-----END CERTIFICATE-----
. . .
-----END CERTIFICATE-----
&lt;/cert&gt;

&lt;key&gt;
-----BEGIN PRIVATE KEY-----
. . .
-----END PRIVATE KEY-----
&lt;/key&gt;</code></pre></figure>

<p><code class="highlighter-rouge">client1.crt</code> ファイルにはいくつかの追加情報も含まれています。ファイル全体を含めて問題ありません。</p>

<p>変更内容を保存して終了します。これで、<code class="highlighter-rouge">client1</code> を構成するための一元化された <strong>OpenVPN</strong> クライアント・プロファイルが得られました。</p>

<p>ここからは、選択した VPN クライアントに対して <code class="highlighter-rouge">.ovpn</code> ファイルをフィードする必要があります。VPN クライアントは、Tunnelblick、Viscosity (両方とも OSX 用)、または任意のものでかまいません。</p>

<p>ただし、このテストを行う前に、このトラフィックが通過できるように OpenStack を準備しておく必要があります。以下のインスタンスを確認してください。</p>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash"><span class="gp">$ </span>nova list +--------------------------------------+----------------+--------+------------+-------------+--------------------------------------+
| ID | Name | Status | Task State | Power State | Networks | +--------------------------------------+----------------+--------+------------+-------------+--------------------------------------+
| 4f239959-be46-4fd3-963a-7c70db305d74 | jkbastion | ACTIVE | - | Running | <span class="nv">internal</span><span class="o">=</span>10.230.7.72, 173.247.105.20 | | 0d3c2002-ea02-4311-8142-b622f05407b4 | jkinternal-ssh | ACTIVE | - | Running | <span class="nv">internal</span><span class="o">=</span>10.230.7.68 | | 746e0ef8-48ee-4867-9c9d-e3d53a7e68bc | jkinternal-web | ACTIVE | - | Running | <span class="nv">internal</span><span class="o">=</span>10.230.7.69 | +--------------------------------------+----------------+--------+------------+-------------+--------------------------------------+</code></pre></figure>

<p>スペースの制約による書式は別にして、ここでは 3 つのインスタンスが得られています。jkbastion には浮動 IP があり、jkinternal-ssh および jkinternal-web は明らかに web と ssh に関連付けられています (Web VM は nginx を実行中です)。</p>

<p>さらに、セキュリティー・グループを表示して、要塞ホストに UDP 1194 を許可していることを確認します。</p>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash"><span class="gp">$ </span>nova secgroup-list
+--------------------------------------+-----------+------------------------+
| Id                                   | Name      | Description            |
+--------------------------------------+-----------+------------------------+
| 55608023-c88e-4446-b67c-b64e741df5cb | default   | default                |
| f33a4643-4440-4649-8ba6-aef09b00b7f7 | jkbastion | bastion security group |
| dcec8a37-9541-4286-a4ad-0290a44efbae |  jksec    | Jason Kennedy<span class="s1">'s shiz   |
+------------------------------ --------+-----------+------------------------+</span></code></pre></figure>

<p>jkbastion の詳細:</p>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash"><span class="gp">$ </span>nova secgroup-list-rules f33a4643-4440-4649-8ba6-aef09b00b7f7
+-------------+-----------+---------+-----------+--------------+
| IP Protocol | From Port | To Port | IP Range  | Source Group |
+-------------+-----------+---------+-----------+--------------+
| tcp         | 22        | 22      | 0.0.0.0/0 |              |
| udp         | 1194      | 1194    | 0.0.0.0/0 |              |
+-------------+-----------+---------+-----------+--------------+</code></pre></figure>

<p>操作はこれで完了です。VPN が接続され、必要なサービスを使用して内部仮想マシンにアクセスできるはずです。</p>

      </div>
    </div>

  </div>
</article>

      </div>
    </div>

    <footer class="site-footer">

  <div class="footer__wrapper--light">

    <ul class="footer--nav">
      <li class="footer--nav__header">
        <a href="https://www.ibm.com/cloud-computing/bluemix/bluemix-private-cloud">Products</a>
      </li>
      <li class="footer--nav__item">
        <a href="https://www.ibm.com/cloud-computing/bluemix/bluemix-private-cloud" class="nav--item__link">Bluemix Private Cloud</a>
      </li>
      <li class="footer--nav__item">
        <a href="https://www.ibm.com/cloud-computing/bluemix/private-cloud-local" class="nav--item__link">Private Cloud Local</a>
      </li>
      <li class="footer--nav__item">
        <a href="https://www.ibm.com/cloud-computing/bluemix/private-cloud-contact-us" class="nav--item__link">Sales</a>
      </li>
      <li class="footer--nav__item">
        <a href="https://www.ibm.com/cloud-computing/bluemix/private-cloud-faq" class="nav--item__link">FAQs</a>
      </li>
    
    </ul>

    <ul class="footer--nav">
      <li class="footer--nav__header">
        <a href="https://www.ibm.com/cloud-computing/bluemix/bluemix-private-cloud">Our Story</a>
      </li>
 <li class="footer--nav__item">
        <a href="https://github.com/blueboxgroup?cm_mc_uid=04946053248414876234663&cm_mc_sid_50200000=1489010497" class="nav--item__link">On GitHub</a>
      </li>
      <li class="footer--nav__item">
        <a href="https://blueboxstatus.com/" class="nav--item__link">System Status</a>
      </li>
      <li class="footer--nav__item">
        <a href="https://support.bluebox.net/" class="nav--item__link">Support</a>
      </li>
      <li class="footer--nav__item">
        <a href="https://support.bluebox.net/" class="nav--item__link">Box Panel</a>
      </li>
    </ul>

    <ul class="footer--nav">
      <li class="footer--nav__header">
        <a href="https://www.ibm.com/cloud-computing/bluemix/bluemix-private-cloud">Resources
        </a>
      </li>
      <li class="footer--nav__item">
        <a href="https://www.ibm.com/cloud-computing/bluemix/bluemix-private-cloud">Case Studies</a>
      </li>
      <li class="footer--nav__item">
        <a href="https://www.ibm.com/cloud-computing/bluemix/bluemix-private-cloud" class="nav--item__link">Videos</a>
      </li>
      <li class="footer--nav__item">
        <a href="https://www.ibm.com/cloud-computing/bluemix/bluemix-private-cloud" class="nav--item__link">News</a>
      </li>
    </ul>

    <ul class="footer--nav">
      <li class="footer--nav__header">
        <a href="hhttps://www.ibm.com/blogs/bluemix/">Recent Blog Posts</a>
      </li>
      <li class="footer--nav__item">
        <a href="https://www.ibm.com/blogs/bluemix/2016/07/the-power-of-openstack/" class="nav--item__link">The Power of OpenStack</a>
      </li>
      <li class="footer--nav__item">
        <a href="https://www.ibm.com/blogs/bluemix/2016/08/blue-box-storage-models-explained/" class="nav--item__link">IBM Bluemix Private Cloud Storage Models</a>
      </li>
      <li class="footer--nav__item">
        <a href="https://www.blueboxcloud.com/insight/blog-article/github-ibm-com-running-on-blue-box" class="nav--item__link">IBM Github Runs on Bluemix Private Cloud</a>
      </li>
      <li class="footer--nav__item">
        <a href="https://www.ibm.com/blogs/bluemix/2016/10/building-up-to-openstack/" class="nav--item__link">Building up to OpenStack</a>
      </li>
      <li class="footer--nav__item">
        <a href="https://www.ibm.com/blogs/bluemix/2016/07/keystone-to-keystone-federated-identity-on-blue-box-cloud/" class="nav--item__link">Get Started with Keystone Federation</a>
      </li>
    </ul>
  </div>
  <div class="footer__wrapper--dark">
    <ul class="footer--list">
      <li class="list--item">
        <a href="https://www.facebook.com/BlueBoxGroup/" class="list--item__link">Facebook</a>
      </li>
      <li class="list--item">
        <a href="https://twitter.com/bluebox?ref_src=twsrc%5Egoogle%7Ctwcamp%5Eserp%7Ctwgr%5Eauthor" class="list--item__link">Twitter</a>
      </li>
      <li class="list--item">
        <a href="https://www.linkedin.com/company/blue-box-group" class="list--item__link">LinkedIn</a>
      </li>
      <li class="list--item">
        <a href="https://plus.google.com/+BlueBoxSeattle/posts" class="list--item__link">Google +</a>
      </li>
      <li class="list--item">
        <a href="https://github.com/blueboxgroup" class="list--item__link">GitHub</a>
      </li>
    </ul>

    <ul class="footer--list">
      <li class="list--item">
        <a href="https://www.ibm.com/cloud-computing/bluemix/private-cloud-contact-us" class="list--item__link">Contact</a>
      </li>
      <li class="list--item">
        <a href="https://www.ibm.com/cloud-computing/bluemix/bluemix-private-cloud" class="list--item__link">Legal</a>
      </li>
      <li class="list--item">
        <a href="https://www.ibm.com/cloud-computing/bluemix/bluemix-private-cloud" class="list--item__link">Privacy Policy</a>
      </li>
      <li class="list--item">
        <a href="https://www.ibm.com/cloud-computing/bluemix/bluemix-private-cloud" class="list--item__link">Terms and Conditions</a>
      </li>

    </ul>
  </div>
  <div class="footer__wrapper--black">
    <p>
        &copy; 2017 IBM Bluemix
    </p>
  </div>
</footer>



    <script src="/help-documentation/js/vendor/simple-jekyll-search.js" type="text/javascript"></script>


    <script>
        SimpleJekyllSearch({
          searchInput: document.getElementById('search-input'),
          resultsContainer: document.getElementById('results-container'),
          json: '/help-documentation/search.json',
          searchResultTemplate: '<li class="search-item"><a href="{url}" class="item-title">{title}</a><ul class="tag--list">{tags}</ul></li>'
        });
    </script>
  <script src="/help-documentation/js/scripts.js"></script>

  </body>

</html>
